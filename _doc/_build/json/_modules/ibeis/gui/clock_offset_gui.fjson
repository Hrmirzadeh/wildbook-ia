{"parents": [{"link": "../../../", "title": "Module code"}, {"link": "../../", "title": "ibeis"}], "title": "ibeis.gui.clock_offset_gui", "body": "<h1>Source code for ibeis.gui.clock_offset_gui</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"c1\"># -*- coding: utf-8 -*-</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">Small GUI for asking the user to enter the clock time shown, and moving along a gid list if the first image isn&#39;t a clock</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"k\">import</span> <span class=\"n\">absolute_import</span><span class=\"p\">,</span> <span class=\"n\">division</span><span class=\"p\">,</span> <span class=\"n\">print_function</span>\n<span class=\"kn\">from</span> <span class=\"nn\">functools</span> <span class=\"k\">import</span> <span class=\"n\">partial</span>\n<span class=\"kn\">from</span> <span class=\"nn\">six.moves</span> <span class=\"k\">import</span> <span class=\"nb\">range</span>\n<span class=\"kn\">from</span> <span class=\"nn\">time</span> <span class=\"k\">import</span> <span class=\"n\">mktime</span>\n<span class=\"kn\">from</span> <span class=\"nn\">datetime</span> <span class=\"k\">import</span> <span class=\"n\">date</span><span class=\"p\">,</span> <span class=\"n\">datetime</span>\n<span class=\"kn\">import</span> <span class=\"nn\">utool</span> <span class=\"k\">as</span> <span class=\"nn\">ut</span>\n<span class=\"kn\">import</span> <span class=\"nn\">guitool</span> <span class=\"k\">as</span> <span class=\"nn\">gt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">guitool.__PYQT__</span> <span class=\"k\">import</span> <span class=\"n\">QtWidgets</span>\n<span class=\"kn\">from</span> <span class=\"nn\">guitool.__PYQT__.QtCore</span> <span class=\"k\">import</span> <span class=\"n\">Qt</span>\n<span class=\"kn\">import</span> <span class=\"nn\">plottool</span> <span class=\"k\">as</span> <span class=\"nn\">pt</span>\n<span class=\"p\">(</span><span class=\"nb\">print</span><span class=\"p\">,</span> <span class=\"n\">rrr</span><span class=\"p\">,</span> <span class=\"n\">profile</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">inject2</span><span class=\"p\">(</span><span class=\"vm\">__name__</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[co_gui]&#39;</span><span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">ClockOffsetWidget</span><span class=\"p\">(</span><span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QWidget</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">hack</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[co_gui] Initializing&#39;</span><span class=\"p\">)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[co_gui] gid_list = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">,))</span>\n\n        <span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QWidget</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">parent</span><span class=\"p\">)</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">fnum</span> <span class=\"o\">=</span> <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">next_fnum</span><span class=\"p\">()</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">main_layout</span> <span class=\"o\">=</span> <span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QVBoxLayout</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">)</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">text_layout</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Vertical</span><span class=\"p\">,</span> <span class=\"n\">verticalStretch</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">main_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">text_layout</span><span class=\"p\">)</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">control_layout</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Vertical</span><span class=\"p\">,</span> <span class=\"n\">verticalSizePolicy</span><span class=\"o\">=</span><span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QSizePolicy</span><span class=\"o\">.</span><span class=\"n\">MinimumExpanding</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">main_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">control_layout</span><span class=\"p\">)</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_layout</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Horizontal</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">control_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_layout</span><span class=\"p\">)</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_layout</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Horizontal</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">control_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_layout</span><span class=\"p\">)</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">hack</span> <span class=\"o\">=</span> <span class=\"n\">hack</span>  <span class=\"c1\"># hack for edting the time of a single image</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imax</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span> <span class=\"o\">=</span> <span class=\"n\">gid_list</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">offset</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n        <span class=\"c1\"># Set image datetime with first image</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">get_image_datetime_</span><span class=\"p\">()</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">add_label</span><span class=\"p\">()</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">add_combo_boxes</span><span class=\"p\">()</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">add_buttons</span><span class=\"p\">()</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">update_ui</span><span class=\"p\">()</span>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.resizeEvent\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.resizeEvent\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">resizeEvent</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">ClockOffsetWidget</span><span class=\"p\">,</span> <span class=\"n\">co_wgt</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">resizeEvent</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">image_label</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"c1\"># Hack use signals and slots</span>\n            <span class=\"k\">if</span> <span class=\"nb\">hasattr</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">image_label</span><span class=\"p\">,</span> <span class=\"s1\">&#39;_on_resize_slot&#39;</span><span class=\"p\">):</span>\n                <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">image_label</span><span class=\"o\">.</span><span class=\"n\">_on_resize_slot</span><span class=\"p\">()</span></div>\n        <span class=\"c1\">#print(&#39;resizeEvent&#39;)</span>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.get_image_datetime_\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.get_image_datetime_\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">get_image_datetime_</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Function that extracts the unixtime from an image and stores it</span>\n        <span class=\"n\">utime</span> <span class=\"o\">=</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_image_unixtime</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">[</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span><span class=\"p\">])</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">utime</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">,</span> <span class=\"nb\">int</span><span class=\"p\">))</span> <span class=\"ow\">or</span> <span class=\"n\">utime</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">utime</span> <span class=\"o\">=</span> <span class=\"o\">-</span><span class=\"mi\">1</span>\n        <span class=\"n\">utime</span> <span class=\"o\">=</span> <span class=\"nb\">float</span><span class=\"p\">(</span><span class=\"n\">utime</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span> <span class=\"o\">=</span> <span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">fromtimestamp</span><span class=\"p\">(</span><span class=\"n\">utime</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.update_ui\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.update_ui\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">update_ui</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">hack</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setEnabled</span><span class=\"p\">(</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setEnabled</span><span class=\"p\">(</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span> <span class=\"o\">==</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setEnabled</span><span class=\"p\">(</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setEnabled</span><span class=\"p\">(</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">li</span><span class=\"p\">,</span> <span class=\"n\">idx</span><span class=\"p\">):</span>\n            <span class=\"k\">return</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">li</span><span class=\"p\">)[</span><span class=\"n\">idx</span><span class=\"p\">])</span>\n        <span class=\"c1\"># Update option setting, assume datetime has been updated</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;year&#39;</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">year</span><span class=\"p\">))</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;month&#39;</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">month</span><span class=\"p\">))</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;day&#39;</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">day</span><span class=\"p\">))</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;hour&#39;</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">hour</span><span class=\"p\">))</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">[</span><span class=\"mi\">9</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;minute&#39;</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">minute</span><span class=\"p\">))</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">[</span><span class=\"mi\">11</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">extract_tuple</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;second&#39;</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">second</span><span class=\"p\">))</span>\n\n        <span class=\"c1\"># Redraw image</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">hack</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n                <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">close_figure</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span><span class=\"p\">)</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_images</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">[</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span><span class=\"p\">])</span>\n            <span class=\"n\">figtitle</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;Time Synchronization Picture&quot;</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span><span class=\"p\">,</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imax</span> <span class=\"o\">=</span> <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">,</span> <span class=\"n\">fnum</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">fnum</span><span class=\"p\">,</span> <span class=\"n\">title</span><span class=\"o\">=</span><span class=\"n\">figtitle</span><span class=\"p\">)</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.show_helpmsg\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.show_helpmsg\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">show_helpmsg</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">textblock</span><span class=\"p\">(</span>\n            <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">            This step is for synchronizing the time of the images being imported</span>\n<span class=\"sd\">            with the actual time of the imageset.</span>\n\n<span class=\"sd\">            Use the Previous and Next buttons until the &#39;Time Synchronization Picture&#39; is of the clock</span>\n<span class=\"sd\">            taken at the beginning of the imageset.</span>\n\n<span class=\"sd\">            Once found, change the date and time in the boxes below to match the time of the clock in</span>\n<span class=\"sd\">            the image, and correct the date if necessary.</span>\n\n<span class=\"sd\">            Once done, click &#39;Set&#39; and the difference will be applied to all images currently</span>\n<span class=\"sd\">            being imported.  If you are sure the camera was synchronized, you</span>\n<span class=\"sd\">            can skip this step by pressing &#39;Skip&#39;.</span>\n<span class=\"sd\">            &quot;&quot;&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">user_info</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"o\">=</span><span class=\"n\">msg</span><span class=\"p\">,</span> <span class=\"n\">title</span><span class=\"o\">=</span><span class=\"s1\">&#39;Time Sync Help&#39;</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.add_label\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.add_label\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">add_label</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Very simply adds the text</span>\n        <span class=\"n\">_LABEL</span> <span class=\"o\">=</span> <span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newLabel</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">hack</span><span class=\"p\">:</span>\n            <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">codeblock</span><span class=\"p\">(</span>\n                <span class=\"sd\">&#39;&#39;&#39;</span>\n<span class=\"sd\">                * Find the image of the clock</span>\n<span class=\"sd\">                * Set the sliders to correspond with the clock</span>\n<span class=\"sd\">                * Click Set</span>\n<span class=\"sd\">                * Skip if time synchonization is not relevant to you</span>\n<span class=\"sd\">                &#39;&#39;&#39;</span>\n            <span class=\"p\">)</span>\n            <span class=\"n\">main_label</span> <span class=\"o\">=</span> <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">align</span><span class=\"o\">=</span><span class=\"s1\">&#39;left&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">text_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">main_label</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">codeblock</span><span class=\"p\">(</span>\n                <span class=\"sd\">&#39;&#39;&#39;</span>\n<span class=\"sd\">                * Set the time for image %r</span>\n<span class=\"sd\">                &#39;&#39;&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">,)</span>\n            <span class=\"p\">)</span>\n            <span class=\"n\">gpath</span> <span class=\"o\">=</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_image_paths</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">[</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span><span class=\"p\">])</span>\n            <span class=\"n\">image_label</span> <span class=\"o\">=</span> <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"n\">gpath</span><span class=\"o\">=</span><span class=\"n\">gpath</span><span class=\"p\">)</span>  <span class=\"c1\"># align=&#39;left&#39;)</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">image_label</span> <span class=\"o\">=</span> <span class=\"n\">image_label</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">text_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">image_label</span><span class=\"p\">)</span></div>\n            <span class=\"c1\">#main_label = _LABEL(text=text, align=&#39;left&#39;)</span>\n            <span class=\"c1\">#co_wgt.text_layout.addWidget(main_label)</span>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.add_buttons\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.add_buttons\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">add_buttons</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"n\">_BUTTON</span> <span class=\"o\">=</span> <span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newButton</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">hack</span><span class=\"p\">:</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n                <span class=\"n\">_BUTTON</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;Previous Image&#39;</span><span class=\"p\">,</span>\n                        <span class=\"n\">clicked</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">go_prev</span><span class=\"p\">),</span>\n                <span class=\"n\">_BUTTON</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;Next Image&#39;</span><span class=\"p\">,</span>\n                        <span class=\"n\">clicked</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">go_next</span><span class=\"p\">),</span>\n                <span class=\"n\">_BUTTON</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;Skip&#39;</span><span class=\"p\">,</span>\n                        <span class=\"n\">clicked</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">cancel</span><span class=\"p\">),</span>\n                <span class=\"n\">_BUTTON</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;Set&#39;</span><span class=\"p\">,</span>\n                        <span class=\"n\">clicked</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">),</span>\n                <span class=\"n\">_BUTTON</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;Help&#39;</span><span class=\"p\">,</span>\n                        <span class=\"n\">clicked</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">show_helpmsg</span><span class=\"p\">),</span>\n            <span class=\"p\">]</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n                <span class=\"n\">_BUTTON</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">&#39;Accept&#39;</span><span class=\"p\">,</span>\n                        <span class=\"n\">clicked</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">),</span>\n            <span class=\"p\">]</span>\n        <span class=\"c1\"># Copying from inspect_gui</span>\n\n        <span class=\"k\">for</span> <span class=\"n\">button</span> <span class=\"ow\">in</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_list</span><span class=\"p\">:</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">button_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">button</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.add_combo_boxes\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.add_combo_boxes\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">add_combo_boxes</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"n\">_CBOX</span> <span class=\"o\">=</span> <span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newComboBox</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"p\">)</span>\n        <span class=\"n\">_LABEL</span> <span class=\"o\">=</span> <span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newLabel</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">align</span><span class=\"o\">=</span><span class=\"s1\">&#39;right&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">def</span> <span class=\"nf\">to_opt_list</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">):</span>\n            <span class=\"k\">return</span> <span class=\"p\">[(</span><span class=\"s2\">&quot;</span><span class=\"si\">%02d</span><span class=\"s2\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">i</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x</span><span class=\"p\">]</span>\n        <span class=\"n\">year_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">fromtimestamp</span><span class=\"p\">(</span><span class=\"n\">unixtime</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">year</span>\n                     <span class=\"k\">for</span> <span class=\"n\">unixtime</span> <span class=\"ow\">in</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_image_unixtime</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">)</span>\n                     <span class=\"k\">if</span> <span class=\"n\">unixtime</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">]</span>\n        <span class=\"n\">max_year</span> <span class=\"o\">=</span> <span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">year_list</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"n\">date</span><span class=\"o\">.</span><span class=\"n\">today</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">year</span><span class=\"p\">])</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n        <span class=\"n\">min_year</span> <span class=\"o\">=</span> <span class=\"nb\">min</span><span class=\"p\">(</span><span class=\"n\">year_list</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">1970</span><span class=\"p\">])</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>\n        <span class=\"c1\">#max_year = date.today().year + 1</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;year&#39;</span><span class=\"p\">:</span> <span class=\"n\">to_opt_list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">min_year</span><span class=\"p\">,</span> <span class=\"n\">max_year</span><span class=\"p\">)),</span>\n            <span class=\"s1\">&#39;month&#39;</span><span class=\"p\">:</span> <span class=\"n\">to_opt_list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">13</span><span class=\"p\">))</span> <span class=\"p\">,</span>\n            <span class=\"s1\">&#39;day&#39;</span><span class=\"p\">:</span> <span class=\"n\">to_opt_list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">32</span><span class=\"p\">)),</span>  <span class=\"c1\"># yes this will allow invalid dates, but it&#39;s not a real issue</span>\n            <span class=\"s1\">&#39;hour&#39;</span><span class=\"p\">:</span> <span class=\"n\">to_opt_list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">24</span><span class=\"p\">)),</span>\n            <span class=\"s1\">&#39;minute&#39;</span><span class=\"p\">:</span> <span class=\"n\">to_opt_list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">60</span><span class=\"p\">)),</span>\n            <span class=\"s1\">&#39;second&#39;</span><span class=\"p\">:</span> <span class=\"n\">to_opt_list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">60</span><span class=\"p\">)),</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">&quot;YYYY&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_CBOX</span><span class=\"p\">(</span><span class=\"n\">changed</span><span class=\"o\">=</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">change_dt</span><span class=\"p\">,</span> <span class=\"s1\">&#39;year&#39;</span><span class=\"p\">),</span>\n                  <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;year&#39;</span><span class=\"p\">],</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">year</span><span class=\"p\">),</span>\n            <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">&quot;MM&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_CBOX</span><span class=\"p\">(</span><span class=\"n\">changed</span><span class=\"o\">=</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">change_dt</span><span class=\"p\">,</span> <span class=\"s1\">&#39;month&#39;</span><span class=\"p\">),</span>\n                  <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;month&#39;</span><span class=\"p\">],</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">month</span><span class=\"p\">),</span>\n            <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">&quot;DD&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_CBOX</span><span class=\"p\">(</span><span class=\"n\">changed</span><span class=\"o\">=</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">change_dt</span><span class=\"p\">,</span> <span class=\"s1\">&#39;day&#39;</span><span class=\"p\">),</span>\n                  <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;day&#39;</span><span class=\"p\">],</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">day</span><span class=\"p\">),</span>\n            <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">&quot;HH (24H)&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_CBOX</span><span class=\"p\">(</span><span class=\"n\">changed</span><span class=\"o\">=</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">change_dt</span><span class=\"p\">,</span> <span class=\"s1\">&#39;hour&#39;</span><span class=\"p\">),</span>\n                  <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;hour&#39;</span><span class=\"p\">],</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">hour</span><span class=\"p\">),</span>\n            <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">&quot;mm&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_CBOX</span><span class=\"p\">(</span><span class=\"n\">changed</span><span class=\"o\">=</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">change_dt</span><span class=\"p\">,</span> <span class=\"s1\">&#39;minute&#39;</span><span class=\"p\">),</span>\n                  <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;minute&#39;</span><span class=\"p\">],</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">minute</span><span class=\"p\">),</span>\n            <span class=\"n\">_LABEL</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">&quot;ss&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_CBOX</span><span class=\"p\">(</span><span class=\"n\">changed</span><span class=\"o\">=</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">change_dt</span><span class=\"p\">,</span> <span class=\"s1\">&#39;second&#39;</span><span class=\"p\">),</span>\n                  <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"s1\">&#39;second&#39;</span><span class=\"p\">],</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">second</span><span class=\"p\">),</span>\n        <span class=\"p\">]</span>\n\n        <span class=\"k\">for</span> <span class=\"n\">combo</span> <span class=\"ow\">in</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_list</span><span class=\"p\">:</span>\n            <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">combo_layout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">combo</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.go_prev\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.go_prev\">[docs]</a>    <span class=\"nd\">@gt</span><span class=\"o\">.</span><span class=\"n\">slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">go_prev</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Decrement current gid index, then call update</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span> <span class=\"o\">-=</span> <span class=\"mi\">1</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">get_image_datetime_</span><span class=\"p\">()</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">update_ui</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.go_next\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.go_next\">[docs]</a>    <span class=\"nd\">@gt</span><span class=\"o\">.</span><span class=\"n\">slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">go_next</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Increment current gid index, then call update</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">get_image_datetime_</span><span class=\"p\">()</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">update_ui</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.cancel\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.cancel\">[docs]</a>    <span class=\"nd\">@gt</span><span class=\"o\">.</span><span class=\"n\">slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">cancel</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Just close</span>\n        <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">close_figure</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.accept\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.accept\">[docs]</a>    <span class=\"nd\">@gt</span><span class=\"o\">.</span><span class=\"n\">slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">accept</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Calculate offset</span>\n        <span class=\"c1\"># Get current image&#39;s actual time</span>\n        <span class=\"n\">image_time</span> <span class=\"o\">=</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_image_unixtime</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">[</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">current_gindex</span><span class=\"p\">])</span>\n        <span class=\"c1\"># Get unixtime from current dtime</span>\n        <span class=\"n\">input_time</span> <span class=\"o\">=</span> <span class=\"n\">mktime</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">timetuple</span><span class=\"p\">())</span>\n        <span class=\"c1\"># Go through gid list, and add that offset to every unixtime</span>\n        <span class=\"n\">offset</span> <span class=\"o\">=</span> <span class=\"n\">input_time</span> <span class=\"o\">-</span> <span class=\"n\">image_time</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;[co_gui] Unixtime offset is </span><span class=\"si\">%d</span><span class=\"s2\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">offset</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Set the unixtimes with the new ones</span>\n        <span class=\"n\">utimes</span> <span class=\"o\">=</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_image_unixtime</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">)</span>\n        <span class=\"n\">new_utimes</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">time</span> <span class=\"o\">+</span> <span class=\"n\">offset</span> <span class=\"k\">for</span> <span class=\"n\">time</span> <span class=\"ow\">in</span> <span class=\"n\">utimes</span><span class=\"p\">]</span>\n        <span class=\"c1\"># SHOULD WE BE USING image_timedelta_posix INSTEAD OF THIS?</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">set_image_unixtime</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">new_utimes</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Close</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">hack</span><span class=\"p\">:</span>\n            <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">close_figure</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">imfig</span><span class=\"p\">)</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"ClockOffsetWidget.change_dt\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.ClockOffsetWidget.change_dt\">[docs]</a>    <span class=\"nd\">@gt</span><span class=\"o\">.</span><span class=\"n\">slot_</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"nb\">str</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">change_dt</span><span class=\"p\">(</span><span class=\"n\">co_wgt</span><span class=\"p\">,</span> <span class=\"n\">attr</span><span class=\"p\">,</span> <span class=\"n\">val_ind</span><span class=\"p\">,</span> <span class=\"n\">val</span><span class=\"p\">):</span>\n        <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span> <span class=\"o\">=</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"o\">.</span><span class=\"n\">replace</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"p\">{</span><span class=\"n\">attr</span><span class=\"p\">:</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">opt_list</span><span class=\"p\">[</span><span class=\"n\">attr</span><span class=\"p\">][</span><span class=\"n\">val_ind</span><span class=\"p\">][</span><span class=\"mi\">1</span><span class=\"p\">]})</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;[co_gui] Base datetime is </span><span class=\"si\">%r</span><span class=\"s2\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">dtime</span><span class=\"p\">)</span></div></div>\n\n\n<div class=\"viewcode-block\" id=\"clock_offset_test\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.clock_offset_gui.clock_offset_test\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">clock_offset_test</span><span class=\"p\">():</span>\n    <span class=\"sa\">r</span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    CommandLine:</span>\n<span class=\"sd\">        python -m ibeis.gui.clock_offset_gui --test-clock_offset_test</span>\n\n<span class=\"sd\">    Example:</span>\n<span class=\"sd\">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">        &gt;&gt;&gt; from ibeis.gui.clock_offset_gui import *  # NOQA</span>\n<span class=\"sd\">        &gt;&gt;&gt; # build test data</span>\n<span class=\"sd\">        &gt;&gt;&gt; # execute function</span>\n<span class=\"sd\">        &gt;&gt;&gt; result = clock_offset_test()</span>\n<span class=\"sd\">        &gt;&gt;&gt; # verify results</span>\n<span class=\"sd\">        &gt;&gt;&gt; print(result)</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">ibeis</span>\n    <span class=\"n\">main_locals</span> <span class=\"o\">=</span> <span class=\"n\">ibeis</span><span class=\"o\">.</span><span class=\"n\">main</span><span class=\"p\">(</span><span class=\"n\">db</span><span class=\"o\">=</span><span class=\"s1\">&#39;testdb1&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">main_locals</span><span class=\"p\">[</span><span class=\"s1\">&#39;ibs&#39;</span><span class=\"p\">]</span>\n    <span class=\"n\">gid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_valid_gids</span><span class=\"p\">()</span>\n    <span class=\"n\">co</span> <span class=\"o\">=</span> <span class=\"n\">ClockOffsetWidget</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">hack</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"n\">co</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n    <span class=\"n\">ibeis</span><span class=\"o\">.</span><span class=\"n\">main_loop</span><span class=\"p\">(</span><span class=\"n\">main_locals</span><span class=\"p\">)</span></div>\n\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;__main__&#39;</span><span class=\"p\">:</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    CommandLine:</span>\n<span class=\"sd\">        python -m ibeis.gui.clock_offset_gui</span>\n<span class=\"sd\">        python -m ibeis.gui.clock_offset_gui --allexamples</span>\n<span class=\"sd\">        python -m ibeis.gui.clock_offset_gui --allexamples --noface --nosrc</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">multiprocessing</span>\n    <span class=\"n\">multiprocessing</span><span class=\"o\">.</span><span class=\"n\">freeze_support</span><span class=\"p\">()</span>  <span class=\"c1\"># for win32</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">utool</span> <span class=\"k\">as</span> <span class=\"nn\">ut</span>  <span class=\"c1\"># NOQA</span>\n    <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">doctest_funcs</span><span class=\"p\">()</span>\n</pre></div>", "current_page_name": "_modules/ibeis/gui/clock_offset_gui", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}