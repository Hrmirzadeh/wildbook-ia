{"parents": [{"link": "../../../", "title": "Module code"}, {"link": "../../", "title": "ibeis"}], "title": "ibeis.gui.newgui", "body": "<h1>Source code for ibeis.gui.newgui</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"ch\">#!/usr/bin/env python</span>\n<span class=\"c1\"># -*- coding: utf-8 -*-</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">This should probably be renamed guifront.py This defines all of the visual</span>\n<span class=\"sd\">components to the GUI It is invoked from guiback, which handles the nonvisual</span>\n<span class=\"sd\">logic.</span>\n\n\n<span class=\"sd\">BUGS:</span>\n<span class=\"sd\">    * Copying the ungrouped imageset raises an error. Should have the option</span>\n<span class=\"sd\">    to copy or move it. Other special imageset should not have this option.</span>\n\n<span class=\"sd\">    Should gray out an option if it is not available.</span>\n\n\n<span class=\"sd\">CommandLine:</span>\n<span class=\"sd\">    ibeis --dbdir ~/lev/media/hdd/work/WWF_Lynx/ --name-tab</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"k\">import</span> <span class=\"n\">absolute_import</span><span class=\"p\">,</span> <span class=\"n\">division</span><span class=\"p\">,</span> <span class=\"n\">print_function</span>\n<span class=\"kn\">from</span> <span class=\"nn\">six.moves</span> <span class=\"k\">import</span> <span class=\"nb\">zip</span><span class=\"p\">,</span> <span class=\"nb\">map</span><span class=\"p\">,</span> <span class=\"nb\">filter</span>\n<span class=\"kn\">from</span> <span class=\"nn\">os.path</span> <span class=\"k\">import</span> <span class=\"n\">isdir</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n<span class=\"kn\">import</span> <span class=\"nn\">functools</span>\n<span class=\"kn\">import</span> <span class=\"nn\">utool</span> <span class=\"k\">as</span> <span class=\"nn\">ut</span>\n<span class=\"kn\">from</span> <span class=\"nn\">guitool.__PYQT__</span> <span class=\"k\">import</span> <span class=\"n\">QtCore</span>\n<span class=\"kn\">from</span> <span class=\"nn\">guitool.__PYQT__</span> <span class=\"k\">import</span> <span class=\"n\">QtWidgets</span>\n<span class=\"kn\">from</span> <span class=\"nn\">guitool.__PYQT__.QtCore</span> <span class=\"k\">import</span> <span class=\"n\">Qt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">guitool</span> <span class=\"k\">import</span> <span class=\"n\">slot_</span><span class=\"p\">,</span> <span class=\"n\">ChangeLayoutContext</span>\n<span class=\"c1\"># from guitool import BlockContext</span>\n<span class=\"c1\"># from guitool import checks_qt_error</span>\n<span class=\"kn\">import</span> <span class=\"nn\">guitool</span> <span class=\"k\">as</span> <span class=\"nn\">gt</span>\n<span class=\"kn\">import</span> <span class=\"nn\">plottool</span> <span class=\"k\">as</span> <span class=\"nn\">pt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">plottool</span> <span class=\"k\">import</span> <span class=\"n\">color_funcs</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.gui</span> <span class=\"k\">import</span> <span class=\"n\">guiheaders</span> <span class=\"k\">as</span> <span class=\"n\">gh</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.gui</span> <span class=\"k\">import</span> <span class=\"n\">guimenus</span>\n<span class=\"kn\">import</span> <span class=\"nn\">six</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.viz.interact</span> <span class=\"k\">import</span> <span class=\"n\">interact_annotations2</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.gui.guiheaders</span> <span class=\"k\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"n\">IMAGE_GRID</span><span class=\"p\">,</span> <span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span> <span class=\"n\">NAME_TABLE</span><span class=\"p\">,</span> <span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span>\n    <span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.gui.models_and_views</span> <span class=\"k\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">IBEISStripeModel</span><span class=\"p\">,</span> <span class=\"n\">IBEISTableView</span><span class=\"p\">,</span> <span class=\"n\">IBEISItemModel</span><span class=\"p\">,</span> <span class=\"n\">IBEISTreeView</span><span class=\"p\">,</span>\n    <span class=\"n\">ImagesetTableModel</span><span class=\"p\">,</span> <span class=\"n\">ImagesetTableView</span><span class=\"p\">,</span> <span class=\"n\">IBEISTableWidget</span><span class=\"p\">,</span>\n    <span class=\"n\">IBEISTreeWidget</span><span class=\"p\">,</span> <span class=\"n\">ImagesetTableWidget</span><span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis</span> <span class=\"k\">import</span> <span class=\"n\">constants</span> <span class=\"k\">as</span> <span class=\"n\">const</span>\n<span class=\"nb\">print</span><span class=\"p\">,</span> <span class=\"n\">rrr</span><span class=\"p\">,</span> <span class=\"n\">profile</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">inject2</span><span class=\"p\">(</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">VERBOSE_GUI</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">VERBOSE</span> <span class=\"ow\">or</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">((</span><span class=\"s1\">&#39;--verbose-gui&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;--verbgui&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">WITH_GUILOG</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--guilog&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\">#############################</span>\n<span class=\"c1\">###### Tab Widgets #######</span>\n<span class=\"c1\">#############################</span>\n\n\n<div class=\"viewcode-block\" id=\"APITabWidget\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.APITabWidget\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">APITabWidget</span><span class=\"p\">(</span><span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QTabWidget</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Holds the table-tabs</span>\n\n<span class=\"sd\">    use setCurrentIndex to change the selection</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"n\">tabwgt</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">horizontalStretch</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">):</span>\n        <span class=\"c1\">#QtWidgets.QTabWidget.__init__(tabwgt, parent)</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">APITabWidget</span><span class=\"p\">,</span> <span class=\"n\">tabwgt</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"p\">)</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span> <span class=\"o\">=</span> <span class=\"n\">parent</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">_sizePolicy</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newSizePolicy</span><span class=\"p\">(</span>\n            <span class=\"n\">tabwgt</span><span class=\"p\">,</span> <span class=\"n\">horizontalStretch</span><span class=\"o\">=</span><span class=\"n\">horizontalStretch</span><span class=\"p\">)</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">setSizePolicy</span><span class=\"p\">(</span><span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">_sizePolicy</span><span class=\"p\">)</span>\n        <span class=\"c1\">#tabwgt.currentChanged.connect(tabwgt.setCurrentIndex)</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">currentChanged</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">_on_tabletab_change</span><span class=\"p\">)</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">current_tblname</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_on_tabletab_change</span><span class=\"p\">(</span><span class=\"n\">tabwgt</span><span class=\"p\">,</span> <span class=\"n\">index</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot; Switch to the current imageset tab &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[apitab] _onchange(index=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">,))</span>\n        <span class=\"n\">tblname</span> <span class=\"o\">=</span> <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">current_tblname</span> <span class=\"o\">=</span> <span class=\"n\">tblname</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[apitab] _onchange(tblname=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">,))</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">_clear_selection</span><span class=\"p\">()</span>\n        <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n        <span class=\"n\">selected</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">selectionModel</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">selection</span><span class=\"p\">()</span>\n        <span class=\"n\">deselected</span> <span class=\"o\">=</span> <span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QItemSelection</span><span class=\"p\">()</span>\n        <span class=\"n\">tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_selection</span><span class=\"p\">(</span><span class=\"n\">selected</span><span class=\"p\">,</span> <span class=\"n\">deselected</span><span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"ImageSetTabWidget\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.ImageSetTabWidget\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">ImageSetTabWidget</span><span class=\"p\">(</span><span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QTabWidget</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Handles tabs that contain individual image sets.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">horizontalStretch</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">):</span>\n        <span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QTabWidget</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"p\">)</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span> <span class=\"o\">=</span> <span class=\"n\">parent</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">setTabsClosable</span><span class=\"p\">(</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">setMaximumSize</span><span class=\"p\">(</span><span class=\"mi\">9999</span><span class=\"p\">,</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">get_cplat_tab_height</span><span class=\"p\">())</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">tabbar</span> <span class=\"o\">=</span> <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">tabBar</span><span class=\"p\">()</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">tabbar</span><span class=\"o\">.</span><span class=\"n\">setMovable</span><span class=\"p\">(</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">setStyleSheet</span><span class=\"p\">(</span><span class=\"s1\">&#39;border: none;&#39;</span><span class=\"p\">)</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">tabbar</span><span class=\"o\">.</span><span class=\"n\">setStyleSheet</span><span class=\"p\">(</span><span class=\"s1\">&#39;border: none;&#39;</span><span class=\"p\">)</span>\n        <span class=\"n\">sizePolicy</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newSizePolicy</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">horizontalStretch</span><span class=\"o\">=</span><span class=\"n\">horizontalStretch</span><span class=\"p\">)</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">setSizePolicy</span><span class=\"p\">(</span><span class=\"n\">sizePolicy</span><span class=\"p\">)</span>\n\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">tabCloseRequested</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">_close_tab</span><span class=\"p\">)</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">currentChanged</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">_on_imagesettab_change</span><span class=\"p\">)</span>\n\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"c1\"># TURNING ON / OFF ALL IMAGES</span>\n        <span class=\"c1\"># imageset_tabwgt._add_imageset_tab(-1, const.ALL_IMAGE_IMAGESETTEXT)</span>\n\n    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_on_imagesettab_change</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">index</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot; Switch to the current imageset tab &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[imageset_tab_widget] _onchange(index=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">,))</span>\n        <span class=\"k\">if</span> <span class=\"mi\">0</span> <span class=\"o\">&lt;=</span> <span class=\"n\">index</span> <span class=\"ow\">and</span> <span class=\"n\">index</span> <span class=\"o\">&lt;</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">):</span>\n            <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[IMAGESETTAB.ONCHANGE] imgsetid = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">,))</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_change_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_change_imageset</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_close_tab</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">index</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[imageset_tab_widget] _close_tab(index=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">,))</span>\n        <span class=\"k\">if</span> <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"o\">.</span><span class=\"n\">pop</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">removeTab</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_close_all_tabs</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[imageset_tab_widget] _close_all_tabs()&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">while</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"o\">.</span><span class=\"n\">pop</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">removeTab</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_close_tab_with_imgsetid</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[imageset_tab_widget] _close_tab_with_imgsetid(imgsetid=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">))</span>\n        <span class=\"k\">try</span><span class=\"p\">:</span>\n            <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">_close_tab</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span>\n        <span class=\"k\">except</span><span class=\"p\">:</span>\n            <span class=\"k\">pass</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_add_imageset_tab</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[_add_imageset_tab] imgsetid=</span><span class=\"si\">%r</span><span class=\"s1\">, imagesettext=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span>\n                <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">))</span>\n        <span class=\"k\">if</span> <span class=\"n\">imgsetid</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[_add_imageset_tab] adding new image tab&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>\n            <span class=\"n\">tab_name</span> <span class=\"o\">=</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">imagesettext</span><span class=\"p\">)</span>\n            <span class=\"c1\"># Only has a tab, doesn&#39;t actually contain anything</span>\n            <span class=\"n\">hack_newtab</span> <span class=\"o\">=</span> <span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QWidget</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">)</span>\n            <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">addTab</span><span class=\"p\">(</span><span class=\"n\">hack_newtab</span><span class=\"p\">,</span> <span class=\"n\">tab_name</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[_add_imageset_tab] using existing image tab&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[_add_imageset_tab] setCurrentIndex(index=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">,))</span>\n        <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Dont call this, it is triggered twice</span>\n        <span class=\"c1\">#imageset_tabwgt._on_imagesettab_change(index)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_update_imageset_tab_name</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">):</span>\n        <span class=\"k\">for</span> <span class=\"n\">index</span><span class=\"p\">,</span> <span class=\"n\">_id</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">imgsetid_list</span><span class=\"p\">):</span>\n            <span class=\"k\">if</span> <span class=\"n\">imgsetid</span> <span class=\"o\">==</span> <span class=\"n\">_id</span><span class=\"p\">:</span>\n                <span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">setTabText</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">)</span></div>\n\n\n<span class=\"c1\">#############################</span>\n<span class=\"c1\">######## Main Widget ########</span>\n<span class=\"c1\">#############################</span>\n\n\n<div class=\"viewcode-block\" id=\"IBEISMainWindow\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISMainWindow\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">IBEISMainWindow</span><span class=\"p\">(</span><span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QMainWindow</span><span class=\"p\">):</span>\n    <span class=\"n\">quitSignal</span> <span class=\"o\">=</span> <span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">pyqtSignal</span><span class=\"p\">()</span>\n    <span class=\"n\">dropSignal</span> <span class=\"o\">=</span> <span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">pyqtSignal</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"n\">mainwin</span><span class=\"p\">,</span> <span class=\"n\">back</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">IBEISMainWindow</span><span class=\"p\">,</span> <span class=\"n\">mainwin</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Menus</span>\n        <span class=\"k\">try</span><span class=\"p\">:</span>\n            <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">setUnifiedTitleAndToolBarOnMac</span><span class=\"p\">(</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n        <span class=\"k\">except</span> <span class=\"ne\">AttributeError</span> <span class=\"k\">as</span> <span class=\"n\">ex</span><span class=\"p\">:</span>\n            <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">printex</span><span class=\"p\">(</span><span class=\"n\">ex</span><span class=\"p\">,</span> <span class=\"s1\">&#39;setUnifiedTitleAndToolBarOnMac is not working&#39;</span><span class=\"p\">,</span> <span class=\"n\">iswarning</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"n\">guimenus</span><span class=\"o\">.</span><span class=\"n\">setup_menus</span><span class=\"p\">(</span><span class=\"n\">mainwin</span><span class=\"p\">,</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Central Widget</span>\n        <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span> <span class=\"o\">=</span> <span class=\"n\">IBEISGuiWidget</span><span class=\"p\">(</span><span class=\"n\">back</span><span class=\"o\">=</span><span class=\"n\">back</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"o\">=</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">mainwin</span><span class=\"p\">)</span>\n        <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">setCentralWidget</span><span class=\"p\">(</span><span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n        <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">setAcceptDrops</span><span class=\"p\">(</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">back</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">quitSignal</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">quit</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">AssertionError</span><span class=\"p\">(</span><span class=\"s1\">&#39;need backend&#39;</span><span class=\"p\">)</span>\n        <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">dropSignal</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imagesDropped</span><span class=\"p\">)</span>\n        <span class=\"c1\">#</span>\n        <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">resize</span><span class=\"p\">(</span><span class=\"mi\">900</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">)</span>\n\n<div class=\"viewcode-block\" id=\"IBEISMainWindow.closeEvent\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISMainWindow.closeEvent\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">closeEvent</span><span class=\"p\">(</span><span class=\"n\">mainwin</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">):</span>\n        <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">()</span>\n        <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">quitSignal</span><span class=\"o\">.</span><span class=\"n\">emit</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISMainWindow.dragEnterEvent\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISMainWindow.dragEnterEvent\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">dragEnterEvent</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">mimeData</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">hasUrls</span><span class=\"p\">:</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">()</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">ignore</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISMainWindow.dropEvent\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISMainWindow.dropEvent\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">dropEvent</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">mimeData</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">hasUrls</span><span class=\"p\">:</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">setDropAction</span><span class=\"p\">(</span><span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">CopyAction</span><span class=\"p\">)</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">()</span>\n            <span class=\"n\">links</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n            <span class=\"k\">for</span> <span class=\"n\">url</span> <span class=\"ow\">in</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">mimeData</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">urls</span><span class=\"p\">():</span>\n                <span class=\"n\">links</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"o\">.</span><span class=\"n\">toLocalFile</span><span class=\"p\">()))</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">dropSignal</span><span class=\"o\">.</span><span class=\"n\">emit</span><span class=\"p\">(</span><span class=\"n\">links</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">ignore</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISMainWindow.expand_names_tree\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISMainWindow.expand_names_tree\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">expand_names_tree</span><span class=\"p\">(</span><span class=\"n\">mainwin</span><span class=\"p\">):</span>\n        <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">mainwin</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">]</span>\n        <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">expandAll</span><span class=\"p\">()</span></div></div>\n\n\n<span class=\"c1\">#############################</span>\n<span class=\"c1\">##### IBEIS GUI Widget ######</span>\n<span class=\"c1\">#############################</span>\n\n\n<span class=\"n\">IBEIS_WIDGET_BASE</span> <span class=\"o\">=</span> <span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QWidget</span>\n\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">IBEISGuiWidget</span><span class=\"p\">(</span><span class=\"n\">IBEIS_WIDGET_BASE</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    CommandLine:</span>\n<span class=\"sd\">        # Testing</span>\n<span class=\"sd\">        python -m ibeis --db NNP_Master3 --onlyimgtbl</span>\n<span class=\"sd\">        python -m ibeis --db PZ_Master1 --onlyimgtbl</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">back</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">IBEISGuiWidget</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span> <span class=\"o\">=</span> <span class=\"n\">back</span>\n        <span class=\"c1\"># Structures that will hold models and views</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span>       <span class=\"o\">=</span> <span class=\"p\">{}</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span>        <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n        <span class=\"c1\"># FIXME: Duplicate models</span>\n        <span class=\"c1\"># Create models and views</span>\n        <span class=\"c1\"># Define the abstract item models and views for the tables</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span>   <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n\n        <span class=\"c1\"># NEW DYNAMIC WAY OF USING TABS AND API VIEWS</span>\n        <span class=\"c1\"># ADD IMAGE TABLE</span>\n        <span class=\"k\">if</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"n\">IBEISTableWidget</span><span class=\"p\">,</span>\n                                          <span class=\"n\">IBEISItemModel</span><span class=\"p\">,</span> <span class=\"n\">IBEISTableView</span><span class=\"p\">))</span>\n        <span class=\"c1\"># ADD IMAGE GRID</span>\n        <span class=\"n\">USE_GRID</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n        <span class=\"k\">if</span> <span class=\"n\">USE_GRID</span> <span class=\"ow\">and</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--onlyimgtbl&#39;</span><span class=\"p\">):</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">IMAGE_GRID</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">IMAGE_GRID</span><span class=\"p\">,</span> <span class=\"n\">IBEISTableWidget</span><span class=\"p\">,</span>\n                                          <span class=\"n\">IBEISStripeModel</span><span class=\"p\">,</span> <span class=\"n\">IBEISTableView</span><span class=\"p\">))</span>\n        <span class=\"c1\"># ADD ANNOT GRID</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--noannottbl&#39;</span><span class=\"p\">)</span> <span class=\"ow\">or</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--onlyimgtbl&#39;</span><span class=\"p\">)):</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span>\n                                          <span class=\"n\">IBEISTableWidget</span><span class=\"p\">,</span> <span class=\"n\">IBEISItemModel</span><span class=\"p\">,</span>\n                                          <span class=\"n\">IBEISTableView</span><span class=\"p\">))</span>\n        <span class=\"c1\"># ADD NAME TREE</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--nonametree&#39;</span><span class=\"p\">)</span> <span class=\"ow\">or</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--onlyimgtbl&#39;</span><span class=\"p\">)):</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span> <span class=\"n\">IBEISTreeWidget</span><span class=\"p\">,</span>\n                                          <span class=\"n\">IBEISItemModel</span><span class=\"p\">,</span> <span class=\"n\">IBEISTreeView</span><span class=\"p\">))</span>\n        <span class=\"c1\"># ADD IMAGESET TABLE</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">super_tblname_list</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">]</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">,</span>  <span class=\"n\">ImagesetTableWidget</span><span class=\"p\">,</span>\n                                      <span class=\"n\">ImagesetTableModel</span><span class=\"p\">,</span> <span class=\"n\">ImagesetTableView</span><span class=\"p\">))</span>\n\n        <span class=\"c1\"># DO INITALIZATION</span>\n        <span class=\"c1\"># Create and layout components</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_init_components</span><span class=\"p\">()</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_connect_signals_and_slots</span><span class=\"p\">()</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">connect_ibeis_control</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Lazy load data every so often</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">data_load_timer</span> <span class=\"o\">=</span> <span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QTimer</span><span class=\"p\">()</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">data_load_timer</span><span class=\"o\">.</span><span class=\"n\">timeout</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">data_load_loop</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">data_load_freq</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span>\n        <span class=\"c1\">#ibswgt.tt = None</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">data_load_timer</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">data_load_freq</span><span class=\"p\">)</span>\n\n    <span class=\"c1\">#@QtCore.pyqtSlot</span>\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.data_load_loop\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.data_load_loop\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">data_load_loop</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Get the current view</span>\n        <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"o\">.</span><span class=\"n\">currentWidget</span><span class=\"p\">()</span>\n        <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">canFetchMore</span><span class=\"p\">(</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n            <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">fetchMore</span><span class=\"p\">(</span><span class=\"kc\">None</span><span class=\"p\">)</span></div>\n        <span class=\"c1\">#if ibswgt.tt is None:</span>\n        <span class=\"c1\">#    ellapsed = ibswgt.data_load_freq</span>\n        <span class=\"c1\">#else:</span>\n        <span class=\"c1\">#    ellapsed = ut.toc(ibswgt.tt)</span>\n        <span class=\"c1\">#print(&#39;Load more data for %r&#39; % (view,))</span>\n        <span class=\"c1\">##freq = ibswgt.data_load_freq / (1000 * 2)</span>\n        <span class=\"c1\">##frac = freq / ellapsed</span>\n        <span class=\"c1\">##print(&#39;ibswgt.data_load_freq = %r&#39; % (freq,))</span>\n        <span class=\"c1\">##print(&#39;ellapsed = %r&#39; % (ellapsed,))</span>\n        <span class=\"c1\">##print(&#39;frac = %r&#39; % (frac,))</span>\n        <span class=\"c1\">##if model.batch_size is not None:</span>\n        <span class=\"c1\">#    #new_batch_size = model.batch_size</span>\n        <span class=\"c1\">#    #new_batch_size = int(new_batch_size * frac * 2)</span>\n        <span class=\"c1\">#    #new_batch_size = max(new_batch_size * 2, 2)</span>\n        <span class=\"c1\">#    #new_batch_size = min(model.batch_size * 2, new_batch_size)</span>\n        <span class=\"c1\">#    #new_batch_size = min(100, new_batch_size)</span>\n        <span class=\"c1\">#    #model.batch_size = new_batch_size</span>\n        <span class=\"c1\">#    #print(&#39;model.batch_size = %r&#39; % (model.batch_size,))</span>\n        <span class=\"c1\">##ibswgt.tt = ut.tic()</span>\n        <span class=\"c1\">#else:</span>\n        <span class=\"c1\">#    ibswgt.tt = None</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_init_components</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot; Defines gui components and inits layout &quot;&quot;&quot;</span>\n        <span class=\"c1\"># Layout</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vlayout</span> <span class=\"o\">=</span> <span class=\"n\">QtWidgets</span><span class=\"o\">.</span><span class=\"n\">QVBoxLayout</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">setLayout</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vlayout</span><span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vsplitter</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newSplitter</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Vertical</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">hsplitter</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newSplitter</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Horizontal</span><span class=\"p\">,</span>\n                                          <span class=\"n\">verticalStretch</span><span class=\"o\">=</span><span class=\"mi\">18</span><span class=\"p\">)</span>\n        <span class=\"c1\">#</span>\n        <span class=\"c1\"># Tables Tab</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span> <span class=\"o\">=</span> <span class=\"n\">APITabWidget</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">horizontalStretch</span><span class=\"o\">=</span><span class=\"mi\">81</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span><span class=\"p\">,</span> <span class=\"n\">WidgetClass</span><span class=\"p\">,</span> <span class=\"n\">ModelClass</span><span class=\"p\">,</span> <span class=\"n\">ViewClass</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">modelview_defs</span><span class=\"p\">:</span>\n            <span class=\"c1\"># Make view first to pass as parent</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>  <span class=\"o\">=</span> <span class=\"n\">ViewClass</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n            <span class=\"c1\"># FIXME: It is very bad to give the model a view. Only the view</span>\n            <span class=\"c1\"># should have a model</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">ModelClass</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">])</span>\n        <span class=\"c1\"># Connect models and views</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">super_tblname_list</span><span class=\"p\">:</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setModel</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">])</span>\n        <span class=\"c1\"># Add Image, ANNOTATION, and Names as tabs</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"p\">:</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"o\">.</span><span class=\"n\">addTab</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">],</span> <span class=\"n\">tblname</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Force full loading</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">batch_size</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">batch_size</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">batch_size</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">batch_size</span> <span class=\"o\">=</span> <span class=\"mi\">2</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">batch_size</span> <span class=\"o\">=</span> <span class=\"mi\">100</span>\n\n        <span class=\"c1\"># Custom ImageSet Tab Wiget</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_tabwgt</span> <span class=\"o\">=</span> <span class=\"n\">ImageSetTabWidget</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vlayout</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vsplitter</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vsplitter</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">hsplitter</span><span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_wgt</span> <span class=\"o\">=</span> <span class=\"n\">status_wgt</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newWidget</span><span class=\"p\">(</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vsplitter</span><span class=\"p\">,</span> <span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Vertical</span><span class=\"p\">,</span> <span class=\"n\">spacing</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">margin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span>\n            <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;StatusWidget&#39;</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">vsplitter</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">status_wgt</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># On the LEFT add the the table of ImageSets</span>\n        <span class=\"n\">imgset_table_view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">]</span>\n        <span class=\"n\">imgset_table_view</span><span class=\"o\">.</span><span class=\"n\">setSizePolicy</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newSizePolicy</span><span class=\"p\">(</span><span class=\"n\">hSizePolicy</span><span class=\"o\">=</span><span class=\"s1\">&#39;Expanding&#39;</span><span class=\"p\">,</span>\n                                                         <span class=\"n\">hStretch</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">))</span>\n\n        <span class=\"c1\"># On the RIGHT add the DataTables and tabs</span>\n        <span class=\"n\">right_hack_wgt</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newWidget</span><span class=\"p\">()</span>\n        <span class=\"n\">right_hack_wgt</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_tabwgt</span><span class=\"p\">)</span>\n        <span class=\"n\">right_hack_wgt</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"p\">)</span>\n        <span class=\"n\">right_hack_wgt</span><span class=\"o\">.</span><span class=\"n\">setSizePolicy</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newSizePolicy</span><span class=\"p\">(</span><span class=\"n\">horizontalStretch</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">))</span>\n\n        <span class=\"c1\"># Hack because the tables aren&#39;t actually belonging to the tabs</span>\n        <span class=\"c1\"># They are just controlled by the change</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">hsplitter</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">imgset_table_view</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">hsplitter</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">right_hack_wgt</span><span class=\"p\">)</span>\n\n        <span class=\"n\">_NEWLBL</span> <span class=\"o\">=</span> <span class=\"n\">functools</span><span class=\"o\">.</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newLabel</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n        <span class=\"n\">_NEWBUT</span> <span class=\"o\">=</span> <span class=\"n\">functools</span><span class=\"o\">.</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newButton</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n        <span class=\"c1\"># _COMBO  = functools.partial(gt.newComboBox, ibswgt)</span>\n        <span class=\"n\">_NEWTEXT</span> <span class=\"o\">=</span> <span class=\"n\">functools</span><span class=\"o\">.</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newLineEdit</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">verticalStretch</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n        <span class=\"n\">primary_fontkw</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">bold</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">pointSize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n        <span class=\"n\">secondary_fontkw</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">bold</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">pointSize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">)</span>\n        <span class=\"c1\"># advanced_fontkw = dict(bold=False, pointSize=8, italic=True)</span>\n        <span class=\"n\">identify_color</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mi\">255</span><span class=\"p\">,</span> <span class=\"mi\">150</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tablename_to_status_widget_index</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n            <span class=\"n\">IMAGE_TABLE</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n            <span class=\"n\">IMAGE_GRID</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n            <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span>\n            <span class=\"n\">NAMES_TREE</span><span class=\"p\">:</span> <span class=\"mi\">7</span><span class=\"p\">,</span>\n            <span class=\"n\">NAME_TABLE</span><span class=\"p\">:</span> <span class=\"mi\">7</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">key_to_objnice</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ImageSet&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">IMAGE_TABLE</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Image&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Annotation&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">NAMES_TREE</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"n\">_NEWLBL</span><span class=\"p\">(</span><span class=\"s1\">&#39;Selected ImageSet: &#39;</span><span class=\"p\">,</span> <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">secondary_fontkw</span><span class=\"p\">,</span> <span class=\"n\">align</span><span class=\"o\">=</span><span class=\"s1\">&#39;right&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">_NEWTEXT</span><span class=\"p\">(</span><span class=\"n\">enabled</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">readOnly</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">),</span>\n            <span class=\"c1\">##</span>\n            <span class=\"n\">_NEWLBL</span><span class=\"p\">(</span><span class=\"s1\">&#39;Selected Image: &#39;</span><span class=\"p\">,</span> <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">secondary_fontkw</span><span class=\"p\">,</span> <span class=\"n\">align</span><span class=\"o\">=</span><span class=\"s1\">&#39;right&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">_NEWTEXT</span><span class=\"p\">(</span><span class=\"n\">enabled</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">readOnly</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                     <span class=\"n\">editingFinishedSlot</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_image_text_editing_finished</span><span class=\"p\">),</span>\n            <span class=\"c1\">##</span>\n            <span class=\"n\">_NEWLBL</span><span class=\"p\">(</span><span class=\"s1\">&#39;Selected Annotation: &#39;</span><span class=\"p\">,</span> <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">secondary_fontkw</span><span class=\"p\">,</span> <span class=\"n\">align</span><span class=\"o\">=</span><span class=\"s1\">&#39;right&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">_NEWTEXT</span><span class=\"p\">(</span><span class=\"n\">enabled</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">readOnly</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                     <span class=\"n\">editingFinishedSlot</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_annot_text_editing_finished</span><span class=\"p\">),</span>\n            <span class=\"c1\">##</span>\n            <span class=\"n\">_NEWLBL</span><span class=\"p\">(</span><span class=\"s1\">&#39;Selected Name: &#39;</span><span class=\"p\">,</span> <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">secondary_fontkw</span><span class=\"p\">,</span> <span class=\"n\">align</span><span class=\"o\">=</span><span class=\"s1\">&#39;right&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">_NEWTEXT</span><span class=\"p\">(</span><span class=\"n\">enabled</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">readOnly</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                     <span class=\"n\">editingFinishedSlot</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_name_text_editing_finished</span><span class=\"p\">),</span>\n        <span class=\"p\">]</span>\n\n        <span class=\"n\">back</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">batch_intra_occurrence_query_button</span> <span class=\"o\">=</span> <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;4) ID Encounters&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">functools</span><span class=\"o\">.</span><span class=\"n\">partial</span><span class=\"p\">(</span>\n                <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">compute_queries</span><span class=\"p\">,</span>\n                <span class=\"n\">daids_mode</span><span class=\"o\">=</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">INTRA_OCCUR_KEY</span><span class=\"p\">,</span>\n                <span class=\"n\">query_is_known</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n                <span class=\"n\">use_prioritized_name_subset</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                <span class=\"n\">cfgdict</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;can_match_samename&#39;</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"s1\">&#39;use_k_padding&#39;</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">}</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"n\">color_funcs</span><span class=\"o\">.</span><span class=\"n\">adjust_hsv_of_rgb255</span><span class=\"p\">(</span><span class=\"n\">identify_color</span><span class=\"p\">,</span>\n                                                     <span class=\"o\">-</span><span class=\"mf\">0.01</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.0</span><span class=\"p\">),</span>\n            <span class=\"n\">fgcolor</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n            <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">batch_vsexemplar_query_button</span> <span class=\"o\">=</span> <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;5) ID Exemplars&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">functools</span><span class=\"o\">.</span><span class=\"n\">partial</span><span class=\"p\">(</span>\n                <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">compute_queries</span><span class=\"p\">,</span>\n                <span class=\"n\">daids_mode</span><span class=\"o\">=</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">VS_EXEMPLARS_KEY</span><span class=\"p\">,</span>\n                <span class=\"n\">use_prioritized_name_subset</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span>\n                <span class=\"n\">query_is_known</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n                <span class=\"n\">cfgdict</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;can_match_samename&#39;</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"s1\">&#39;use_k_padding&#39;</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">},</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"n\">color_funcs</span><span class=\"o\">.</span><span class=\"n\">adjust_hsv_of_rgb255</span><span class=\"p\">(</span><span class=\"n\">identify_color</span><span class=\"p\">,</span>\n                                                     <span class=\"o\">-</span><span class=\"mf\">0.02</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.0</span><span class=\"p\">),</span>\n            <span class=\"n\">fgcolor</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n            <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">import_button</span> <span class=\"o\">=</span> <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;1) Import&#39;</span><span class=\"p\">,</span>\n            <span class=\"c1\"># back.import_images_from_dir,</span>\n            <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">import_button_click</span><span class=\"p\">,</span>\n            <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">235</span><span class=\"p\">,</span> <span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"mi\">200</span><span class=\"p\">),</span> <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span><span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_button</span> <span class=\"o\">=</span> <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;2) Group&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">do_group_occurrence_step</span><span class=\"p\">,</span>\n            <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">255</span><span class=\"p\">,</span> <span class=\"mi\">255</span><span class=\"p\">,</span> <span class=\"mi\">150</span><span class=\"p\">),</span> <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span><span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">detect_button</span> <span class=\"o\">=</span> <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;3) Detect&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">run_detection_step</span><span class=\"p\">,</span>\n            <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">150</span><span class=\"p\">,</span> <span class=\"mi\">255</span><span class=\"p\">,</span> <span class=\"mi\">150</span><span class=\"p\">),</span>\n            <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">reviewed_button</span> <span class=\"o\">=</span> <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;6) Complete&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">commit_to_wb_step</span><span class=\"p\">,</span>\n            <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"n\">color_funcs</span><span class=\"o\">.</span><span class=\"n\">adjust_hsv_of_rgb255</span><span class=\"p\">((</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">232</span><span class=\"p\">,</span> <span class=\"mi\">211</span><span class=\"p\">),</span> <span class=\"mf\">0.</span><span class=\"p\">,</span> <span class=\"o\">-.</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mf\">0.</span><span class=\"p\">),</span>\n            <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span><span class=\"p\">,</span>\n            <span class=\"n\">enabled</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">control_widget_lists</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"p\">[</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">import_button</span><span class=\"p\">,</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_button</span><span class=\"p\">,</span>\n                <span class=\"n\">_NEWLBL</span><span class=\"p\">(</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">),</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">detect_button</span><span class=\"p\">,</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">batch_intra_occurrence_query_button</span><span class=\"p\">,</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">batch_vsexemplar_query_button</span><span class=\"p\">,</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">reviewed_button</span><span class=\"p\">,</span>\n            <span class=\"p\">],</span>\n            <span class=\"p\">[</span>\n                <span class=\"n\">_NEWBUT</span><span class=\"p\">(</span>\n                    <span class=\"s1\">&#39;Advanced ID Interface&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_advanced_id_interface</span><span class=\"p\">,</span>\n                    <span class=\"n\">bgcolor</span><span class=\"o\">=</span><span class=\"n\">color_funcs</span><span class=\"o\">.</span><span class=\"n\">adjust_hsv_of_rgb255</span><span class=\"p\">(</span><span class=\"n\">identify_color</span><span class=\"p\">),</span>\n                    <span class=\"n\">fgcolor</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">fontkw</span><span class=\"o\">=</span><span class=\"n\">primary_fontkw</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">]</span>\n        <span class=\"p\">]</span>\n\n        <span class=\"c1\"># Other components</span>\n        <span class=\"c1\"># New widget has black magic (for implicit layouts) in it</span>\n        <span class=\"c1\"># Add control widgets (import, group, species selector, etc...)</span>\n        <span class=\"k\">for</span> <span class=\"n\">count</span><span class=\"p\">,</span> <span class=\"n\">control_widgets</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">control_widget_lists</span><span class=\"p\">):</span>\n            <span class=\"n\">_container</span> <span class=\"o\">=</span> <span class=\"n\">status_wgt</span><span class=\"o\">.</span><span class=\"n\">addNewWidget</span><span class=\"p\">(</span><span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Horizontal</span><span class=\"p\">,</span>\n                                                 <span class=\"n\">margin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span>\n                                                 <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;ControlContainer</span><span class=\"si\">%d</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span>\n                                                 <span class=\"p\">(</span><span class=\"n\">count</span><span class=\"p\">,))</span>\n            <span class=\"k\">for</span> <span class=\"n\">widget</span> <span class=\"ow\">in</span> <span class=\"n\">control_widgets</span><span class=\"p\">:</span>\n                <span class=\"n\">_container</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">widget</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Output log (turned off by default)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">outputLog</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">newOutputLog</span><span class=\"p\">(</span>\n            <span class=\"n\">status_wgt</span><span class=\"p\">,</span> <span class=\"n\">pointSize</span><span class=\"o\">=</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"n\">visible</span><span class=\"o\">=</span><span class=\"n\">WITH_GUILOG</span><span class=\"p\">,</span>\n            <span class=\"n\">verticalStretch</span><span class=\"o\">=</span><span class=\"mi\">6</span><span class=\"p\">)</span>\n        <span class=\"n\">status_wgt</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">outputLog</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Add selected ids status widget</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">selectionStatusWidget</span> <span class=\"o\">=</span> <span class=\"n\">status_wgt</span><span class=\"o\">.</span><span class=\"n\">addNewWidget</span><span class=\"p\">(</span><span class=\"n\">orientation</span><span class=\"o\">=</span><span class=\"n\">Qt</span><span class=\"o\">.</span><span class=\"n\">Horizontal</span><span class=\"p\">,</span>\n                                                               <span class=\"n\">margin</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span>\n                                                               <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;SelectionStatus&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">widget</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span><span class=\"p\">:</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">selectionStatusWidget</span><span class=\"o\">.</span><span class=\"n\">addWidget</span><span class=\"p\">(</span><span class=\"n\">widget</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Progress bar is at the bottom</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">prog_bar</span> <span class=\"o\">=</span> <span class=\"n\">status_wgt</span><span class=\"o\">.</span><span class=\"n\">addNewProgressBar</span><span class=\"p\">(</span><span class=\"n\">visible</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                                                       <span class=\"n\">verticalStretch</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span>\n                                                       <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;prog_bar&#39;</span><span class=\"p\">)</span>\n\n        <span class=\"c1\">#ibswgt.vsplitter.print_widget_heirarchy(max_depth=4)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_connect_signals_and_slots</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] _connect_signals_and_slots&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">super_tblname_list</span><span class=\"p\">:</span>\n            <span class=\"n\">tblview</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n            <span class=\"n\">tblview</span><span class=\"o\">.</span><span class=\"n\">doubleClicked</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">on_doubleclick</span><span class=\"p\">)</span>\n            <span class=\"n\">tblview</span><span class=\"o\">.</span><span class=\"n\">contextMenuClicked</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">on_contextMenuClicked</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">tblname</span> <span class=\"o\">!=</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">:</span>\n                <span class=\"n\">tblview</span><span class=\"o\">.</span><span class=\"n\">selectionModel</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">selectionChanged</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_selection</span><span class=\"p\">)</span>\n            <span class=\"c1\">#front.printSignal.connect(back.backend_print)</span>\n            <span class=\"c1\">#front.raiseExceptionSignal.connect(back.backend_exception)</span>\n            <span class=\"c1\"># CONNECT HOOK TO GET NUM ROWS</span>\n            <span class=\"n\">tblview</span><span class=\"o\">.</span><span class=\"n\">rows_updated</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">on_rows_updated</span><span class=\"p\">)</span>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.update_selection\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.update_selection\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QItemSelection</span><span class=\"p\">,</span> <span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QItemSelection</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">update_selection</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">selected</span><span class=\"p\">,</span> <span class=\"n\">deselected</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Quirky behavior: if you select two columns in a row and then unselect</span>\n<span class=\"sd\">        only one, the whole row is unselected, because this function only deals</span>\n<span class=\"sd\">        with deltas.</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront()</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.set_table_tab(gh.NAMES_TREE)</span>\n<span class=\"sd\">            &gt;&gt;&gt; view = ibswgt.views[gh.NAMES_TREE]</span>\n<span class=\"sd\">            &gt;&gt;&gt; view.expandAll()</span>\n<span class=\"sd\">            &gt;&gt;&gt; AUTOSELECT = False</span>\n<span class=\"sd\">            &gt;&gt;&gt; if AUTOSELECT:</span>\n<span class=\"sd\">            ...     view.selectAll()</span>\n<span class=\"sd\">            &gt;&gt;&gt; selmodel = view.selectionModel()</span>\n<span class=\"sd\">            &gt;&gt;&gt; selected = selmodel.selection()</span>\n<span class=\"sd\">            &gt;&gt;&gt; deselected = QtCore.QItemSelection()</span>\n<span class=\"sd\">            &gt;&gt;&gt; # verify results</span>\n<span class=\"sd\">            &gt;&gt;&gt; print(result)</span>\n\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"c1\">#print(&#39;[ibswgt] update selection&#39;)</span>\n        <span class=\"c1\">#print(&#39;selected = &#39; + str(selected.indexes()))</span>\n        <span class=\"c1\">#print(&#39;deselected = &#39; + str(deselected.indexes()))</span>\n        <span class=\"n\">deselected_model_index_list_</span> <span class=\"o\">=</span> <span class=\"n\">deselected</span><span class=\"o\">.</span><span class=\"n\">indexes</span><span class=\"p\">()</span>\n        <span class=\"n\">selected_model_index_list_</span>   <span class=\"o\">=</span> <span class=\"n\">selected</span><span class=\"o\">.</span><span class=\"n\">indexes</span><span class=\"p\">()</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">get_selection_info</span><span class=\"p\">(</span><span class=\"n\">model_index_list_</span><span class=\"p\">):</span>\n            <span class=\"n\">model_index_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">qtindex</span> <span class=\"k\">for</span> <span class=\"n\">qtindex</span> <span class=\"ow\">in</span> <span class=\"n\">model_index_list_</span> <span class=\"k\">if</span> <span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">()]</span>\n            <span class=\"n\">model_list</span>       <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">qtindex</span> <span class=\"ow\">in</span> <span class=\"n\">model_index_list</span><span class=\"p\">]</span>\n            <span class=\"n\">tablename_list</span>   <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"k\">for</span> <span class=\"n\">model</span> <span class=\"ow\">in</span> <span class=\"n\">model_list</span><span class=\"p\">]</span>\n            <span class=\"n\">level_list</span>       <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n                                <span class=\"k\">for</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">model_list</span><span class=\"p\">,</span> <span class=\"n\">model_index_list</span><span class=\"p\">)]</span>\n            <span class=\"n\">rowid_list</span>       <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n                                <span class=\"k\">for</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">model_list</span><span class=\"p\">,</span> <span class=\"n\">model_index_list</span><span class=\"p\">)]</span>\n            <span class=\"n\">table_key_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">tablename_list</span><span class=\"p\">,</span> <span class=\"n\">level_list</span><span class=\"p\">))</span>\n            <span class=\"k\">return</span> <span class=\"n\">table_key_list</span><span class=\"p\">,</span> <span class=\"n\">rowid_list</span>\n\n        <span class=\"n\">select_table_key_list</span><span class=\"p\">,</span> <span class=\"n\">select_rowid_list</span> <span class=\"o\">=</span> <span class=\"n\">get_selection_info</span><span class=\"p\">(</span>\n            <span class=\"n\">selected_model_index_list_</span><span class=\"p\">)</span>\n        <span class=\"n\">deselect_table_key_list</span><span class=\"p\">,</span> <span class=\"n\">deselect_rowid_list</span> <span class=\"o\">=</span> <span class=\"n\">get_selection_info</span><span class=\"p\">(</span>\n            <span class=\"n\">deselected_model_index_list_</span><span class=\"p\">)</span>\n\n        <span class=\"n\">table_key2_selected_rowids</span>   <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">group_items</span><span class=\"p\">(</span><span class=\"n\">select_rowid_list</span><span class=\"p\">,</span>\n                                                           <span class=\"n\">select_table_key_list</span><span class=\"p\">))</span>\n        <span class=\"n\">table_key2_deselected_rowids</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">group_items</span><span class=\"p\">(</span><span class=\"n\">deselect_rowid_list</span><span class=\"p\">,</span>\n                                                           <span class=\"n\">deselect_table_key_list</span><span class=\"p\">))</span>\n\n        <span class=\"n\">table_key2_selected_rowids</span>   <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"n\">key</span><span class=\"p\">:</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">val</span><span class=\"p\">))</span>\n            <span class=\"k\">for</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">val</span> <span class=\"ow\">in</span> <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">(</span><span class=\"n\">table_key2_selected_rowids</span><span class=\"p\">)}</span>\n        <span class=\"n\">table_key2_deselected_rowids</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"n\">key</span><span class=\"p\">:</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">val</span><span class=\"p\">))</span>\n            <span class=\"k\">for</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">val</span> <span class=\"ow\">in</span> <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">(</span><span class=\"n\">table_key2_deselected_rowids</span><span class=\"p\">)}</span>\n        <span class=\"k\">if</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">VERBOSE</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;table_key2_selected_rowids = &#39;</span> <span class=\"o\">+</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">repr2</span><span class=\"p\">(</span><span class=\"n\">table_key2_selected_rowids</span><span class=\"p\">))</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;table_key2_deselected_rowids = &#39;</span> <span class=\"o\">+</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">repr2</span><span class=\"p\">(</span><span class=\"n\">table_key2_deselected_rowids</span><span class=\"p\">))</span>\n\n        <span class=\"n\">gh_const_tablename_map</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"p\">(</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>         <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">IMAGE_GRID</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">NAME_TABLE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">NAME_TABLE</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">NAME_TABLE</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"c1\"># here tablename is a backend const tablename</span>\n        <span class=\"k\">for</span> <span class=\"n\">table_key</span><span class=\"p\">,</span> <span class=\"n\">id_list</span> <span class=\"ow\">in</span> <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">(</span><span class=\"n\">table_key2_deselected_rowids</span><span class=\"p\">):</span>\n            <span class=\"n\">tablename</span> <span class=\"o\">=</span> <span class=\"n\">gh_const_tablename_map</span><span class=\"p\">[</span><span class=\"n\">table_key</span><span class=\"p\">]</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">_set_selection3</span><span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s1\">&#39;diff&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">table_key</span><span class=\"p\">,</span> <span class=\"n\">id_list</span> <span class=\"ow\">in</span> <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">(</span><span class=\"n\">table_key2_selected_rowids</span><span class=\"p\">):</span>\n            <span class=\"n\">tablename</span> <span class=\"o\">=</span> <span class=\"n\">gh_const_tablename_map</span><span class=\"p\">[</span><span class=\"n\">table_key</span><span class=\"p\">]</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">_set_selection3</span><span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s1\">&#39;add&#39;</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">update_selection_texts</span><span class=\"p\">()</span></div>\n\n        <span class=\"c1\">#tblview.selectionModel().selectedIndexes()</span>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.changing_models_gen\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.changing_models_gen\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">changing_models_gen</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tblnames</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Loops over tablenames emitting layoutChanged at the end for each</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"n\">tblnames</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">super_tblname_list</span> <span class=\"k\">if</span> <span class=\"n\">tblnames</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span> <span class=\"k\">else</span> <span class=\"n\">tblnames</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] changing_models_gen(tblnames=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tblnames</span><span class=\"p\">,))</span>\n        <span class=\"n\">model_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">tblnames</span><span class=\"p\">]</span>\n        <span class=\"c1\">#model_list = [ibswgt.models[tblname] for tblname in tblnames if</span>\n        <span class=\"c1\">#ibswgt.views[tblname].isVisible()]</span>\n        <span class=\"k\">with</span> <span class=\"n\">ChangeLayoutContext</span><span class=\"p\">(</span><span class=\"n\">model_list</span><span class=\"p\">):</span>\n            <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">tblnames</span><span class=\"p\">:</span>\n                <span class=\"k\">yield</span> <span class=\"n\">tblname</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.update_tables\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.update_tables\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">update_tables</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tblnames</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">clear_view_selection</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot; forces changing models &quot;&quot;&quot;</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] update_tables(</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tblnames</span><span class=\"p\">,))</span>\n        <span class=\"n\">hack_selections</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"c1\">#print(&#39;[new_gui.UPDATE_TABLES]&#39;)</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">changing_models_gen</span><span class=\"p\">(</span><span class=\"n\">tblnames</span><span class=\"o\">=</span><span class=\"n\">tblnames</span><span class=\"p\">):</span>\n            <span class=\"c1\">#print(&#39;[new_gui.update_tables] tblname=%r&#39; % (tblname, ))</span>\n            <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n            <span class=\"n\">view</span>  <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n            <span class=\"k\">if</span> <span class=\"n\">clear_view_selection</span><span class=\"p\">:</span>\n                <span class=\"n\">hack_selections</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">clearSelection</span><span class=\"p\">)</span>\n            <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_update</span><span class=\"p\">()</span>\n        <span class=\"c1\"># Hack: Call this outside changing models gen</span>\n        <span class=\"k\">for</span> <span class=\"n\">clearSelection</span> <span class=\"ow\">in</span> <span class=\"n\">hack_selections</span><span class=\"p\">:</span>\n            <span class=\"n\">clearSelection</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.connect_ibeis_control\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.connect_ibeis_control\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">connect_ibeis_control</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot; Connects a new ibscontroler to the models &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] connect_ibeis_control(ibs=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,))</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">_close_all_tabs</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"n\">ibs</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] invalid ibs&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;No Database Opened&#39;</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">setWindowTitle</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] Connecting valid ibs=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_dbname</span><span class=\"p\">())</span>\n            <span class=\"c1\">#with ut.Indenter(&#39;[CONNECTING]&#39;):</span>\n            <span class=\"c1\"># Give the frontend the new control</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--fast&#39;</span><span class=\"p\">):</span>\n                <span class=\"k\">with</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">Timer</span><span class=\"p\">(</span><span class=\"s1\">&#39;update special&#39;</span><span class=\"p\">,</span> <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"n\">VERBOSE_GUI</span><span class=\"p\">):</span>\n                    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">readonly</span><span class=\"p\">:</span>\n                        <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">update_special_imagesets</span><span class=\"p\">()</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;Skipping special imagesets&#39;</span><span class=\"p\">)</span>\n            <span class=\"c1\"># Update the api models to use the new control</span>\n            <span class=\"k\">with</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">Timer</span><span class=\"p\">(</span><span class=\"s1\">&#39;make headers&#39;</span><span class=\"p\">,</span> <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"n\">VERBOSE_GUI</span><span class=\"p\">):</span>\n                <span class=\"n\">header_dict</span><span class=\"p\">,</span> <span class=\"n\">declare_tup</span> <span class=\"o\">=</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">make_ibeis_headers_dict</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">declare_tup</span> <span class=\"o\">=</span> <span class=\"n\">declare_tup</span>\n\n            <span class=\"k\">def</span> <span class=\"nf\">get_title</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">):</span>\n                <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">                DEPRICATE OR MOVE</span>\n<span class=\"sd\">                &quot;&quot;&quot;</span>\n                <span class=\"k\">if</span> <span class=\"n\">ibs</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n                    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;IBEIS - No Database Directory Open&#39;</span>\n                <span class=\"k\">elif</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">dbdir</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n                    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;IBEIS - !! INVALID DATABASE !!&#39;</span>\n                <span class=\"k\">else</span><span class=\"p\">:</span>\n                    <span class=\"n\">dbdir</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_dbdir</span><span class=\"p\">()</span>\n                    <span class=\"n\">dbname</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_dbname</span><span class=\"p\">()</span>\n                    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;IBEIS - </span><span class=\"si\">%r</span><span class=\"s1\"> - Database Directory = </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">dbname</span><span class=\"p\">,</span> <span class=\"n\">dbdir</span><span class=\"p\">)</span>\n                    <span class=\"n\">wb_target</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">WILDBOOK_TARGET</span>\n                    <span class=\"c1\">#params.args.wildbook_target</span>\n                    <span class=\"k\">if</span> <span class=\"n\">wb_target</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n                        <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;</span><span class=\"si\">%s</span><span class=\"s1\"> - Wildbook Target = </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">,</span> <span class=\"n\">wb_target</span><span class=\"p\">)</span>\n                <span class=\"k\">return</span> <span class=\"n\">title</span>\n\n            <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"n\">get_title</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">setWindowTitle</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">VERBOSE</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] Calling model _update_headers&#39;</span><span class=\"p\">)</span>\n            <span class=\"c1\">#block_wgt_flag = ibswgt._tables_tab_widget.blockSignals(True)</span>\n\n            <span class=\"k\">with</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">Timer</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] update models&#39;</span><span class=\"p\">,</span> <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"n\">VERBOSE_GUI</span><span class=\"p\">):</span>\n                <span class=\"c1\">#for tblname in ibswgt.changing_models_gen(ibswgt.super_tblname_list):</span>\n                <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">super_tblname_list</span><span class=\"p\">:</span>\n                    <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n                    <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n                    <span class=\"c1\">#if not view.isVisible():</span>\n                    <span class=\"c1\">#    print(view)</span>\n                    <span class=\"c1\">#ut.embed()</span>\n                    <span class=\"n\">header</span> <span class=\"o\">=</span> <span class=\"n\">header_dict</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n                    <span class=\"c1\">#widget = ibswgt.widgets[tblname]</span>\n                    <span class=\"c1\">#widget.change_headers(header)</span>\n                    <span class=\"c1\"># NOT SURE IF THESE BLOCKERS SHOULD BE COMMENTED</span>\n                    <span class=\"c1\">#block_model_flag = model.blockSignals(True)</span>\n                    <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_update_headers</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">header</span><span class=\"p\">)</span>\n                    <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">_update_headers</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">header</span><span class=\"p\">)</span>  <span class=\"c1\"># should use model headers</span>\n                    <span class=\"c1\">#model.blockSignals(block_model_flag)</span>\n                    <span class=\"c1\">#</span>\n                    <span class=\"c1\">#view.infer_delegates_from_model()</span>\n                <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">super_tblname_list</span><span class=\"p\">:</span>\n                    <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n                    <span class=\"c1\">#if not view.isVisible():</span>\n                    <span class=\"c1\">#    print(view)</span>\n                    <span class=\"c1\">#    continue</span>\n                    <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">hide_cols</span><span class=\"p\">()</span>\n            <span class=\"c1\">#ibswgt._tables_tab_widget.blockSignals(block_wgt_flag)</span>\n\n            <span class=\"c1\"># Update species with ones enabled in database</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">readonly</span><span class=\"p\">:</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_species_available</span><span class=\"p\">()</span>\n\n            <span class=\"c1\"># FIXME: bad code</span>\n            <span class=\"c1\"># TODO: load previously loaded imageset or nothing</span>\n            <span class=\"n\">LOAD_IMAGESET_ON_START</span> <span class=\"o\">=</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">get_argflag</span><span class=\"p\">(</span><span class=\"s1\">&#39;--fast&#39;</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">LOAD_IMAGESET_ON_START</span><span class=\"p\">:</span>\n                <span class=\"n\">imgsetid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_valid_imgsetids</span><span class=\"p\">(</span><span class=\"n\">shipped</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                    <span class=\"n\">DEFAULT_LARGEST_IMAGESET</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n                    <span class=\"k\">if</span> <span class=\"n\">DEFAULT_LARGEST_IMAGESET</span><span class=\"p\">:</span>\n                        <span class=\"n\">numImg_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_imageset_num_gids</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)</span>\n                        <span class=\"n\">argx</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">list_argsort</span><span class=\"p\">(</span><span class=\"n\">numImg_list</span><span class=\"p\">,</span> <span class=\"n\">reverse</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n                        <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">imgsetid_list</span><span class=\"p\">[</span><span class=\"n\">argx</span><span class=\"p\">]</span>\n                    <span class=\"k\">else</span><span class=\"p\">:</span>  <span class=\"c1\"># Grab &quot;first&quot; imageset</span>\n                        <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">imgsetid_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n                    <span class=\"c1\">#ibswgt._change_imageset(imgsetid)</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_imageset_tab</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n                <span class=\"k\">else</span><span class=\"p\">:</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_change_imageset</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.update_species_available\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.update_species_available\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">update_species_available</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">reselect</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                                 <span class=\"n\">reselect_new_name</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">deleting</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">):</span>\n        <span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span>\n        <span class=\"c1\"># TODO: update these options depending on ibs.get_species_with_detectors</span>\n        <span class=\"c1\"># when a controller is attached to the gui</span>\n        <span class=\"n\">detection_combo_box_options</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"c1\"># Text              # Value</span>\n            <span class=\"c1\">#(&#39;Select Species&#39;,  &#39;none&#39;),</span>\n            <span class=\"p\">(</span><span class=\"s1\">&#39;Select Species&#39;</span><span class=\"p\">,</span>  <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">UNKNOWN</span><span class=\"p\">),</span>\n            <span class=\"p\">(</span><span class=\"s1\">&#39;Unknown&#39;</span><span class=\"p\">,</span>  <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">UNKNOWN</span><span class=\"p\">),</span>\n            <span class=\"c1\">#&#39;none&#39;),</span>\n        <span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_working_species</span><span class=\"p\">()))</span>\n        <span class=\"n\">species_text</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">get_selected_species</span><span class=\"p\">()</span>\n        <span class=\"n\">reselect_index</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">deleting</span> <span class=\"ow\">and</span> <span class=\"n\">reselect_new_name</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">species_text</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">species_rowid</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_species_rowids_from_text</span><span class=\"p\">(</span><span class=\"n\">species_text</span><span class=\"p\">)</span>\n            <span class=\"n\">reselect_new_name</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_species_nice</span><span class=\"p\">(</span><span class=\"n\">species_rowid</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[front] Reselecting old selection: </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">reselect_new_name</span><span class=\"p\">,</span> <span class=\"p\">))</span>\n        <span class=\"n\">nice_name_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">_</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span> <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"n\">detection_combo_box_options</span> <span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"n\">reselect_new_name</span> <span class=\"ow\">in</span> <span class=\"n\">nice_name_list</span><span class=\"p\">:</span>\n            <span class=\"n\">reselect_index</span> <span class=\"o\">=</span> <span class=\"n\">nice_name_list</span><span class=\"o\">.</span><span class=\"n\">index</span><span class=\"p\">(</span><span class=\"n\">reselect_new_name</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[front] Reselecting renamed selection: </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">reselect_new_name</span><span class=\"p\">,</span> <span class=\"p\">))</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[front] Reselecting index: </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">reselect_index</span><span class=\"p\">,</span> <span class=\"p\">))</span></div>\n        <span class=\"c1\"># ibswgt.species_combo.setOptions(detection_combo_box_options)</span>\n        <span class=\"c1\"># ibswgt.species_combo.updateOptions(reselect=reselect, reselect_index=reselect_index)</span>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.setWindowTitle\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.setWindowTitle\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">setWindowTitle</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">title</span><span class=\"p\">):</span>\n        <span class=\"n\">parent_</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"n\">parent_</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">parent_</span><span class=\"o\">.</span><span class=\"n\">setWindowTitle</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">IBEIS_WIDGET_BASE</span><span class=\"o\">.</span><span class=\"n\">setWindowTitle</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">title</span><span class=\"p\">)</span></div>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_change_imageset</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] _change_imageset(imgsetid=</span><span class=\"si\">%r</span><span class=\"s1\">, uuid=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span>\n                  <span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_imageset_uuid</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)))</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"p\">:</span>\n            <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n            <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">clearSelection</span><span class=\"p\">()</span>\n        <span class=\"k\">for</span> <span class=\"n\">tblname</span> <span class=\"ow\">in</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">changing_models_gen</span><span class=\"p\">(</span><span class=\"n\">tblnames</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tblname_list</span><span class=\"p\">):</span>\n            <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n            <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">_change_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"k\">try</span><span class=\"p\">:</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_imgsetid</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"k\">except</span> <span class=\"ne\">Exception</span> <span class=\"k\">as</span> <span class=\"n\">ex</span><span class=\"p\">:</span>\n            <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">printex</span><span class=\"p\">(</span><span class=\"n\">ex</span><span class=\"p\">,</span> <span class=\"n\">iswarning</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">set_table_tab</span><span class=\"p\">(</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_update_imageset_tab_name</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">):</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">_update_imageset_tab_name</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">)</span>\n\n    <span class=\"c1\">#------------</span>\n    <span class=\"c1\"># SLOT HELPERS</span>\n    <span class=\"c1\">#------------</span>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.get_table_tab_index\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.get_table_tab_index\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">get_table_tab_index</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tblname</span><span class=\"p\">):</span>\n        <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n        <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"o\">.</span><span class=\"n\">indexOf</span><span class=\"p\">(</span><span class=\"n\">view</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">index</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.set_selection_status\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.set_selection_status\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">set_selection_status</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">ids</span><span class=\"p\">):</span>\n        <span class=\"n\">ids</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">)</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"nb\">repr</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">)</span>\n        <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tablename_to_status_widget_index</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">]</span>\n\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">)</span> <span class=\"o\">&lt;=</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n            <span class=\"n\">text2</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;Selected </span><span class=\"si\">%s</span><span class=\"s1\">:&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">key_to_objnice</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">],)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">text2</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;Selected </span><span class=\"si\">%s</span><span class=\"s1\"> </span><span class=\"si\">%s</span><span class=\"s1\">:&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span>\n                <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">),</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">pluralize</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">key_to_objnice</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">],</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">)),)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span><span class=\"p\">[</span><span class=\"n\">index</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setText</span><span class=\"p\">(</span><span class=\"n\">text2</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">setText</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.set_table_tab\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.set_table_tab\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">set_table_tab</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tblname</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Programmatically change to the table-tab to either:</span>\n<span class=\"sd\">        Image, ImageGrid, Annotation, or Names table/tree</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # GUI_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront()</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.set_table_tab(gh.ANNOTATION_TABLE)</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] set_table_tab: </span><span class=\"si\">%r</span><span class=\"s1\"> &#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">,))</span>\n        <span class=\"k\">with</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">Timer</span><span class=\"p\">(</span><span class=\"s1\">&#39;set table tab&#39;</span><span class=\"p\">,</span> <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"n\">VERBOSE_GUI</span><span class=\"p\">):</span>\n            <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">get_table_tab_index</span><span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"o\">.</span><span class=\"n\">setCurrentIndex</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.select_imageset_tab\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.select_imageset_tab\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">select_imageset_tab</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] select_imageset_tab imgsetid=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">,))</span>\n        <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">string_types</span><span class=\"p\">):</span>\n            <span class=\"c1\"># Hack</span>\n            <span class=\"n\">imagesettext</span> <span class=\"o\">=</span> <span class=\"n\">imgsetid</span>\n            <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_imageset_imgsetids_from_text</span><span class=\"p\">(</span><span class=\"n\">imagesettext</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">imagesettext</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_imageset_text</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"c1\">#ibswgt.back.select_imgsetid(imgsetid)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">imageset_tabwgt</span><span class=\"o\">.</span><span class=\"n\">_add_imageset_tab</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">imagesettext</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.spawn_edit_image_annotation_interaction_from_aid\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.spawn_edit_image_annotation_interaction_from_aid\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">spawn_edit_image_annotation_interaction_from_aid</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span>\n                                                         <span class=\"n\">model</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n                                                         <span class=\"n\">qtindex</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        hack for letting annots spawn image editing</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis.gui.newgui spawn_edit_image_annotation_interaction_from_aid --show</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; import ibeis</span>\n<span class=\"sd\">            &gt;&gt;&gt; main_locals = ibeis.main(defaultdb=&#39;testdb1&#39;)</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back = ut.dict_take(main_locals, [&#39;ibs&#39;, &#39;back&#39;])</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt = back.ibswgt  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; aid = 4</span>\n<span class=\"sd\">            &gt;&gt;&gt; imgsetid = 1</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.spawn_edit_image_annotation_interaction_from_aid(aid, imgsetid)</span>\n<span class=\"sd\">            &gt;&gt;&gt; if ut.show_was_requested():</span>\n<span class=\"sd\">            &gt;&gt;&gt;    gt.qtapp_loop(qwin=ibswgt)</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"n\">gid</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_annot_gids</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">model</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">]</span>\n            <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n            <span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"n\">row</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">get_row_and_qtindex_from_id</span><span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">spawn_edit_image_annotation_interaction</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.spawn_edit_image_annotation_interaction\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.spawn_edit_image_annotation_interaction\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">spawn_edit_image_annotation_interaction</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        TODO: needs reimplement using more standard interaction methods</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] Creating new annotation interaction: gid=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">,))</span>\n        <span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span>\n        <span class=\"c1\"># Select gid</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_gid</span><span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">show</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Interact with gid</span>\n        <span class=\"n\">nextcb</span><span class=\"p\">,</span> <span class=\"n\">prevcb</span><span class=\"p\">,</span> <span class=\"n\">current_gid</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_interactannot2_callbacks</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">)</span>\n        <span class=\"n\">iannot2_kw</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;rows_updated_callback&#39;</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_tables</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;next_callback&#39;</span><span class=\"p\">:</span> <span class=\"n\">nextcb</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;prev_callback&#39;</span><span class=\"p\">:</span> <span class=\"n\">prevcb</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">assert</span> <span class=\"n\">current_gid</span> <span class=\"o\">==</span> <span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"s1\">&#39;problem in next/prev updater&#39;</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">annot_interact</span> <span class=\"o\">=</span> <span class=\"n\">interact_annotations2</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_Interaction2</span><span class=\"p\">(</span>\n            <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">iannot2_kw</span><span class=\"p\">)</span>\n        <span class=\"c1\"># hacky GID_PROG: TODO: FIX WITH OTHER HACKS OF THIS TYPE</span>\n        <span class=\"c1\"># FIXME; this should depend on the model.</span>\n        <span class=\"c1\">#_, row = model.view.get_row_and_qtindex_from_id(gid)</span>\n        <span class=\"c1\">#pt.set_figtitle(&#39;%d/%d&#39; % (row + 1, model.rowCount()))</span>\n        <span class=\"n\">level_num_rows</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level_row_count</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n        <span class=\"n\">level_row</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level_row_index</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n        <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">set_figtitle</span><span class=\"p\">(</span><span class=\"s1\">&#39;</span><span class=\"si\">%d</span><span class=\"s1\">/</span><span class=\"si\">%d</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">level_row</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">level_num_rows</span><span class=\"p\">))</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.make_adjacent_qtindex_callbacks\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.make_adjacent_qtindex_callbacks\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">make_adjacent_qtindex_callbacks</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">):</span>\n        <span class=\"sa\">r</span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Returns:</span>\n<span class=\"sd\">            tuple: (current_rowid, next_callback, prev_callback)</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis.gui.newgui --test-make_adjacent_qtindex_callbacks</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront()</span>\n<span class=\"sd\">            &gt;&gt;&gt; gid = ibs.get_valid_gids()[0]</span>\n<span class=\"sd\">            &gt;&gt;&gt; model = ibswgt.models[gh.IMAGE_TABLE]</span>\n<span class=\"sd\">            &gt;&gt;&gt; qtindex, row = model.get_row_and_qtindex_from_id(gid)</span>\n<span class=\"sd\">            &gt;&gt;&gt; tup = ibswgt.make_adjacent_qtindex_callbacks(model, qtindex)</span>\n<span class=\"sd\">            &gt;&gt;&gt; (current_rowid, next_callback, prev_callback) = tup</span>\n<span class=\"sd\">            &gt;&gt;&gt; assert prev_callback is None, &#39;should not be a previous image id&#39;</span>\n<span class=\"sd\">            &gt;&gt;&gt; current_rowid1, next_callback1, prev_callback1 = next_callback()</span>\n<span class=\"sd\">            &gt;&gt;&gt; assert next_callback() is None, &#39;race condition not prevented&#39;</span>\n<span class=\"sd\">            &gt;&gt;&gt; current_rowid2, next_callback2, prev_callback2 = next_callback1()</span>\n<span class=\"sd\">            &gt;&gt;&gt; testdata_main_loop(globals(), locals())</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"n\">current_rowid</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n        <span class=\"n\">next_qtindex</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_adjacent_qtindex</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n        <span class=\"n\">prev_qtindex</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_adjacent_qtindex</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n        <span class=\"n\">next_callback</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n        <span class=\"n\">prev_callback</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n        <span class=\"n\">numclicks</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>  <span class=\"c1\"># semephore, invalidates both functions after one call</span>\n        <span class=\"k\">if</span> <span class=\"n\">next_qtindex</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">next_qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">():</span>\n            <span class=\"k\">def</span> <span class=\"nf\">next_callback</span><span class=\"p\">():</span>\n                <span class=\"k\">if</span> <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">!=</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;race condition in next_callback </span><span class=\"si\">%d</span><span class=\"s1\"> &#39;</span> <span class=\"o\">%</span> <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n                    <span class=\"k\">return</span>\n                <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n                <span class=\"k\">return</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">make_adjacent_qtindex_callbacks</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">next_qtindex</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">prev_qtindex</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">prev_qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">():</span>\n            <span class=\"k\">def</span> <span class=\"nf\">prev_callback</span><span class=\"p\">():</span>\n                <span class=\"k\">if</span> <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">!=</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;race condition in next_callback </span><span class=\"si\">%d</span><span class=\"s1\"> &#39;</span> <span class=\"o\">%</span> <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n                    <span class=\"k\">return</span>\n                <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n                <span class=\"k\">return</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">make_adjacent_qtindex_callbacks</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">next_qtindex</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">current_rowid</span><span class=\"p\">,</span> <span class=\"n\">next_callback</span><span class=\"p\">,</span> <span class=\"n\">prev_callback</span></div>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_interactannot2_callbacks</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        callbacks for the edit image annotation (from image table) interaction</span>\n\n<span class=\"sd\">        python -m ibeis --db lynx --imgsetid 2</span>\n\n<span class=\"sd\">        TODO: needs reimplement</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"c1\">#if not qtindex.isValid():</span>\n        <span class=\"c1\">#    raise AssertionError(&#39;Bug: qtindex got invalidated&#39;)</span>\n        <span class=\"c1\">#    # BUG: somewhere qtindex gets invalidated</span>\n        <span class=\"c1\">#    #return None, None, -1</span>\n        <span class=\"c1\"># HACK FOR NEXT AND PREVIOUS CLICK CALLBACKS</span>\n        <span class=\"c1\">#print(&#39;model.name = %r&#39; % (model.name,))</span>\n        <span class=\"k\">if</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">:</span>\n            <span class=\"n\">cur_gid</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n        <span class=\"c1\"># elif model.name == gh.IMAGE_GRID:</span>\n        <span class=\"c1\">#     cur_gid = model._get_row_id(qtindex)</span>\n        <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">:</span>\n            <span class=\"n\">cur_level</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">cur_level</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">cur_aid</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n                <span class=\"n\">cur_gid</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_annot_gids</span><span class=\"p\">(</span><span class=\"n\">cur_aid</span><span class=\"p\">)</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"k\">raise</span> <span class=\"ne\">NotImplementedError</span><span class=\"p\">(</span><span class=\"s1\">&#39;Unknown model.name=</span><span class=\"si\">%r</span><span class=\"s1\">, cur_level=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">cur_level</span><span class=\"p\">))</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;gh.IMAGE_TABLE = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,))</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">NotImplementedError</span><span class=\"p\">(</span><span class=\"s1\">&#39;Unknown model.name =</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,))</span>\n        <span class=\"n\">next_qtindex</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_adjacent_qtindex</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n        <span class=\"n\">prev_qtindex</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_adjacent_qtindex</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n        <span class=\"n\">numclicks</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>  <span class=\"c1\"># semephore</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">make_qtindex_callback</span><span class=\"p\">(</span><span class=\"n\">qtindex_</span><span class=\"p\">,</span> <span class=\"n\">type_</span><span class=\"o\">=</span><span class=\"s1\">&#39;nextprev&#39;</span><span class=\"p\">):</span>\n            <span class=\"k\">def</span> <span class=\"nf\">_qtindex_callback</span><span class=\"p\">():</span>\n                <span class=\"k\">if</span> <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">!=</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;race condition in </span><span class=\"si\">%s</span><span class=\"s1\">_callback </span><span class=\"si\">%d</span><span class=\"s1\"> &#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">type_</span><span class=\"p\">,</span> <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]))</span>\n                    <span class=\"k\">return</span>\n                <span class=\"n\">numclicks</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n                <span class=\"c1\"># call this function again with next index</span>\n                <span class=\"n\">nextcb</span><span class=\"p\">,</span> <span class=\"n\">prevcb</span><span class=\"p\">,</span> <span class=\"n\">new_gid1</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_interactannot2_callbacks</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex_</span><span class=\"p\">)</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] </span><span class=\"si\">%s</span><span class=\"s1\">_callback: new_gid1=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">type_</span><span class=\"p\">,</span> <span class=\"n\">new_gid1</span><span class=\"p\">))</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">annot_interact</span><span class=\"o\">.</span><span class=\"n\">update_image_and_callbacks</span><span class=\"p\">(</span>\n                    <span class=\"n\">new_gid1</span><span class=\"p\">,</span> <span class=\"n\">nextcb</span><span class=\"p\">,</span> <span class=\"n\">prevcb</span><span class=\"p\">,</span> <span class=\"n\">do_save</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n                <span class=\"c1\"># hacky GID_PROG: TODO: FIX WITH OTHER HACKS OF THIS TYPE</span>\n                <span class=\"c1\">#_, row = model.view.get_row_and_qtindex_from_id(new_gid1)</span>\n                <span class=\"c1\">#pt.set_figtitle(&#39;%d/%d&#39; % (row + 1, model.rowCount()))</span>\n                <span class=\"n\">level_num_rows</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level_row_count</span><span class=\"p\">(</span><span class=\"n\">qtindex_</span><span class=\"p\">)</span>\n                <span class=\"n\">level_row</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level_row_index</span><span class=\"p\">(</span><span class=\"n\">qtindex_</span><span class=\"p\">)</span>\n                <span class=\"n\">pt</span><span class=\"o\">.</span><span class=\"n\">set_figtitle</span><span class=\"p\">(</span><span class=\"s1\">&#39;</span><span class=\"si\">%d</span><span class=\"s1\">/</span><span class=\"si\">%d</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">level_row</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">level_num_rows</span><span class=\"p\">))</span>\n            <span class=\"k\">return</span> <span class=\"n\">_qtindex_callback</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">next_qtindex</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">next_qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">():</span>\n            <span class=\"n\">next_callback</span> <span class=\"o\">=</span> <span class=\"n\">make_qtindex_callback</span><span class=\"p\">(</span><span class=\"n\">next_qtindex</span><span class=\"p\">,</span> <span class=\"s1\">&#39;next&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">next_callback</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">prev_qtindex</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">prev_qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">():</span>\n            <span class=\"n\">prev_callback</span> <span class=\"o\">=</span> <span class=\"n\">make_qtindex_callback</span><span class=\"p\">(</span><span class=\"n\">prev_qtindex</span><span class=\"p\">,</span> <span class=\"s1\">&#39;prev&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">prev_callback</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">next_callback</span><span class=\"p\">,</span> <span class=\"n\">prev_callback</span><span class=\"p\">,</span> <span class=\"n\">cur_gid</span>\n\n    <span class=\"c1\">#------------</span>\n    <span class=\"c1\"># SLOTS</span>\n    <span class=\"c1\">#------------</span>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.select_annot_text_editing_finished\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.select_annot_text_editing_finished\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">select_annot_text_editing_finished</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"n\">tablename</span> <span class=\"o\">=</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span>\n        <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tablename_to_status_widget_index</span><span class=\"p\">[</span><span class=\"n\">tablename</span><span class=\"p\">]</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">()</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_table_indicies_from_text</span><span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.select_name_text_editing_finished\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.select_name_text_editing_finished\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">select_name_text_editing_finished</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"n\">tablename</span> <span class=\"o\">=</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">NAMES_TREE</span>\n        <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tablename_to_status_widget_index</span><span class=\"p\">[</span><span class=\"n\">tablename</span><span class=\"p\">]</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">()</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_table_indicies_from_text</span><span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.select_image_text_editing_finished\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.select_image_text_editing_finished\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">select_image_text_editing_finished</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"n\">tablename</span> <span class=\"o\">=</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span>\n        <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">tablename_to_status_widget_index</span><span class=\"p\">[</span><span class=\"n\">tablename</span><span class=\"p\">]</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">status_widget_list</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">()</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_table_indicies_from_text</span><span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.select_table_indicies_from_text\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.select_table_indicies_from_text\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">select_table_indicies_from_text</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tblname</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">allow_table_change</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Args:</span>\n<span class=\"sd\">            tblname - tablename of the id to parse from text</span>\n\n<span class=\"sd\">        Ignore:</span>\n<span class=\"sd\">            text = &#39;[1, 2,  3,]&#39;</span>\n<span class=\"sd\">               text = &#39;51e10019-968b-5f2e-2287-8432464d7547 &#39;</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # GUI_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront()</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.set_table_tab(gh.ANNOTATION_TABLE)</span>\n<span class=\"sd\">            &gt;&gt;&gt; tblname = gh.NAMES_TREE</span>\n<span class=\"sd\">            &gt;&gt;&gt; text = &#39;lena&#39;</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.select_table_indicies_from_text(tblname, text)</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">QUIET</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] select_table_indicies_from_text&#39;</span><span class=\"p\">)</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui]  * gh.tblname = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">,))</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui]  * text = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">text</span><span class=\"p\">,))</span>\n        <span class=\"n\">to_backend_tablename</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span> <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span>\n            <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">NAMES_TREE</span>       <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">NAME_TABLE</span><span class=\"p\">,</span>\n            <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span>      <span class=\"p\">:</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">backend_tablename</span> <span class=\"o\">=</span> <span class=\"n\">to_backend_tablename</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">QUIET</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui]  * backend_tablename = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">backend_tablename</span><span class=\"p\">,))</span>\n        <span class=\"k\">if</span> <span class=\"n\">text</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">:</span>\n            <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;[]&#39;</span>\n        <span class=\"k\">try</span><span class=\"p\">:</span>\n            <span class=\"c1\">#MODE1 = True</span>\n            <span class=\"c1\">#if MODE1:</span>\n            <span class=\"n\">id_list_</span> <span class=\"o\">=</span> <span class=\"n\">text</span><span class=\"o\">.</span><span class=\"n\">lstrip</span><span class=\"p\">(</span><span class=\"s1\">&#39;[&#39;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">rstrip</span><span class=\"p\">(</span><span class=\"s1\">&#39;]&#39;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;,&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">id_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">id_</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">id_</span> <span class=\"ow\">in</span> <span class=\"n\">id_list_</span><span class=\"p\">]</span>\n            <span class=\"n\">id_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">id_</span> <span class=\"k\">for</span> <span class=\"n\">id_</span> <span class=\"ow\">in</span> <span class=\"n\">id_list</span> <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">id_</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n            <span class=\"k\">try</span><span class=\"p\">:</span>\n                <span class=\"n\">id_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">))</span>\n            <span class=\"k\">except</span> <span class=\"ne\">ValueError</span><span class=\"p\">:</span>\n                <span class=\"kn\">import</span> <span class=\"nn\">uuid</span>\n                <span class=\"k\">try</span><span class=\"p\">:</span>\n                    <span class=\"c1\"># First check to see if the text is a UUID</span>\n                    <span class=\"n\">id_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"n\">uuid</span><span class=\"o\">.</span><span class=\"n\">UUID</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">))</span>\n                <span class=\"k\">except</span> <span class=\"ne\">ValueError</span><span class=\"p\">:</span>\n                    <span class=\"k\">if</span> <span class=\"n\">tblname</span> <span class=\"o\">!=</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">:</span>\n                        <span class=\"k\">raise</span>\n                    <span class=\"k\">else</span><span class=\"p\">:</span>\n                        <span class=\"c1\"># then maybe it was a name that was selected</span>\n                        <span class=\"n\">id_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">))</span>\n            <span class=\"c1\">#else:</span>\n            <span class=\"c1\">#    id_list_ = eval(text, globals(), locals())</span>\n            <span class=\"c1\">#    id_list = ut.ensure_iterable(id_list_)  # NOQA</span>\n        <span class=\"k\">except</span> <span class=\"ne\">Exception</span> <span class=\"k\">as</span> <span class=\"n\">ex</span><span class=\"p\">:</span>\n            <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">printex</span><span class=\"p\">(</span><span class=\"n\">ex</span><span class=\"p\">,</span> <span class=\"n\">iswarning</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">keys</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;text&#39;</span><span class=\"p\">])</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">QUIET</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui]  * id_list = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">id_list</span><span class=\"p\">,))</span>\n            <span class=\"c1\">#print(id_list)</span>\n            <span class=\"n\">id_list</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">_set_selection3</span><span class=\"p\">(</span><span class=\"n\">backend_tablename</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s1\">&#39;set&#39;</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Select the index if we are in the right table tab</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">id_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span> <span class=\"ow\">and</span> <span class=\"p\">(</span>\n           <span class=\"n\">allow_table_change</span> <span class=\"ow\">or</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"o\">.</span><span class=\"n\">current_tblname</span> <span class=\"o\">==</span> <span class=\"n\">tblname</span><span class=\"p\">):</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">QUIET</span><span class=\"p\">:</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui]  * attempting to select from rowid&#39;</span><span class=\"p\">)</span>\n            <span class=\"c1\">#view = ibswgt.views[tblname]</span>\n            <span class=\"c1\">#view.select_row_from_id(id_list[0])</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">goto_table_id</span><span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">,</span> <span class=\"n\">id_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"c1\"># TODO: convert the id into the ids corresponding with this tablename and move</span>\n            <span class=\"c1\"># to the first one</span>\n            <span class=\"k\">pass</span>\n\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">update_selection_texts</span><span class=\"p\">()</span></div>\n        <span class=\"c1\">#pass</span>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.on_rows_updated\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.on_rows_updated\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">on_rows_updated</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tblname</span><span class=\"p\">,</span> <span class=\"n\">nRows</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        When the rows are updated change the tab names</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERBOSE_GUI</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] on_rows_updated: tblname=</span><span class=\"si\">%12r</span><span class=\"s1\"> nRows=</span><span class=\"si\">%r</span><span class=\"s1\"> &#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">,</span> <span class=\"n\">nRows</span><span class=\"p\">))</span>\n        <span class=\"k\">if</span> <span class=\"n\">tblname</span> <span class=\"o\">==</span> <span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">:</span>  <span class=\"c1\"># Hack</span>\n            <span class=\"c1\">#print(&#39;... tblname == IMAGESET_TABLE, ...hack return&#39;)</span>\n            <span class=\"k\">return</span>\n        <span class=\"n\">tblname</span> <span class=\"o\">=</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">)</span>\n        <span class=\"n\">TABLE_NICE</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">declare_tup</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>  <span class=\"c1\"># hack</span>\n        <span class=\"n\">tblnice</span> <span class=\"o\">=</span> <span class=\"n\">TABLE_NICE</span><span class=\"p\">[</span><span class=\"n\">tblname</span><span class=\"p\">]</span>\n        <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">get_table_tab_index</span><span class=\"p\">(</span><span class=\"n\">tblname</span><span class=\"p\">)</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">tblnice</span> <span class=\"o\">+</span> <span class=\"s1\">&#39; &#39;</span> <span class=\"o\">+</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">nRows</span><span class=\"p\">)</span>\n        <span class=\"c1\"># CHANGE TAB NAME TO SHOW NUMBER OF ROWS</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">_tables_tab_widget</span><span class=\"o\">.</span><span class=\"n\">setTabText</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.goto_table_id\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.goto_table_id\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">goto_table_id</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">_id</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[newgui] goto_table_id(tablenamd=</span><span class=\"si\">%r</span><span class=\"s1\">, _id=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">,</span> <span class=\"n\">_id</span><span class=\"p\">))</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">set_table_tab</span><span class=\"p\">(</span><span class=\"n\">tablename</span><span class=\"p\">)</span>\n        <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">tablename</span><span class=\"p\">]</span>\n        <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">select_row_from_id</span><span class=\"p\">(</span><span class=\"n\">_id</span><span class=\"p\">,</span> <span class=\"n\">scroll</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.on_contextMenuClicked\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.on_contextMenuClicked\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QModelIndex</span><span class=\"p\">,</span> <span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QPoint</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">on_contextMenuClicked</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"n\">pos</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Right click anywhere in the GUI</span>\n<span class=\"sd\">        Context menus on right click of a table</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis --db WS_ALL --imgsetid 2 --select-name=A-003</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">():</span>\n            <span class=\"k\">return</span>\n\n        <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n        <span class=\"n\">tblview</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">]</span>\n        <span class=\"n\">context_options</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"n\">qtindex_list</span> <span class=\"o\">=</span> <span class=\"n\">tblview</span><span class=\"o\">.</span><span class=\"n\">selectedIndexes</span><span class=\"p\">()</span>\n        <span class=\"n\">id_list</span>      <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">_qtindex</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">_qtindex</span> <span class=\"ow\">in</span> <span class=\"n\">qtindex_list</span><span class=\"p\">]</span>\n        <span class=\"n\">level_list</span>   <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level</span><span class=\"p\">(</span><span class=\"n\">_qtindex</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">_qtindex</span> <span class=\"ow\">in</span> <span class=\"n\">qtindex_list</span><span class=\"p\">]</span>\n        <span class=\"n\">level2_ids_</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">group_items</span><span class=\"p\">(</span><span class=\"n\">id_list</span><span class=\"p\">,</span> <span class=\"n\">level_list</span><span class=\"p\">)</span>\n        <span class=\"n\">level2_ids</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"n\">level</span><span class=\"p\">:</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">unique_ordered</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">)</span>\n                      <span class=\"k\">for</span> <span class=\"n\">level</span><span class=\"p\">,</span> <span class=\"n\">ids</span> <span class=\"ow\">in</span> <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">(</span><span class=\"n\">level2_ids_</span><span class=\"p\">)}</span>\n\n        <span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span>\n        <span class=\"n\">back</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span>\n\n        <span class=\"n\">col</span> <span class=\"o\">=</span> <span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">column</span><span class=\"p\">()</span>\n        <span class=\"n\">setter_func</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">col_setter_list</span><span class=\"p\">[</span><span class=\"n\">col</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"n\">setter_func</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"c1\"># Make a copy of the list</span>\n            <span class=\"n\">id_list_</span> <span class=\"o\">=</span> <span class=\"n\">id_list</span><span class=\"p\">[:]</span>\n            <span class=\"n\">clone_highlight</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">clone_highlight</span><span class=\"p\">:</span>\n                <span class=\"n\">id_list_</span> <span class=\"o\">=</span> <span class=\"p\">[</span> <span class=\"n\">_</span><span class=\"o\">.</span><span class=\"n\">get_id</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">level_index_list</span> <span class=\"p\">]</span>\n            <span class=\"c1\"># Getter and current value</span>\n            <span class=\"n\">getter_func</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">col_getter_list</span><span class=\"p\">[</span><span class=\"n\">col</span><span class=\"p\">]</span>\n            <span class=\"n\">current_id</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n            <span class=\"n\">current_value</span> <span class=\"o\">=</span> <span class=\"n\">getter_func</span><span class=\"p\">(</span><span class=\"n\">current_id</span><span class=\"p\">)</span>\n            <span class=\"n\">current_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">current_value</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">)</span>\n            <span class=\"c1\"># Add to context menus</span>\n\n            <span class=\"k\">def</span> <span class=\"nf\">_setter_refresh</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">,</span> <span class=\"n\">current_list</span><span class=\"p\">,</span> <span class=\"n\">tablename</span><span class=\"p\">):</span>\n                <span class=\"n\">args</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">current_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">),</span> <span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">are_you_sure</span><span class=\"p\">(</span><span class=\"s1\">&#39;Confirm cloning value </span><span class=\"si\">%s</span><span class=\"s1\"> to </span><span class=\"si\">%d</span><span class=\"s1\"> rows?&#39;</span> <span class=\"o\">%</span> <span class=\"n\">args</span><span class=\"p\">):</span>\n                    <span class=\"k\">return</span>\n                <span class=\"n\">setter_func</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">,</span> <span class=\"n\">current_list</span><span class=\"p\">)</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_tables</span><span class=\"p\">(</span><span class=\"n\">tblnames</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">tablename</span><span class=\"p\">],</span> <span class=\"n\">clear_view_selection</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n            <span class=\"k\">if</span> <span class=\"n\">clone_highlight</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Clone selected value to highlighted rows&#39;</span><span class=\"p\">,</span>\n                     <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">_setter_refresh</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">,</span> <span class=\"n\">current_list</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">),),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Clone selected value to all rows&#39;</span><span class=\"p\">,</span>\n                     <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">_setter_refresh</span><span class=\"p\">(</span><span class=\"n\">id_list_</span><span class=\"p\">,</span> <span class=\"n\">current_list</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">),),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                <span class=\"p\">]</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">build_annot_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">aid_list</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">aid</span> <span class=\"o\">=</span> <span class=\"n\">aid_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n                <span class=\"k\">if</span> <span class=\"n\">kwargs</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\">&#39;goto_image&#39;</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">):</span>\n                    <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                        <span class=\"p\">(</span><span class=\"s1\">&#39;Go to image&#39;</span><span class=\"p\">,</span>\n                         <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">goto_table_id</span><span class=\"p\">(</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span>\n                                                      <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_annot_gids</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">)),)</span>\n                    <span class=\"p\">]</span>\n                <span class=\"k\">if</span> <span class=\"n\">kwargs</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\">&#39;goto_annot&#39;</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">):</span>\n                    <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                        <span class=\"p\">(</span><span class=\"s1\">&#39;Go to annot&#39;</span><span class=\"p\">,</span>\n                         <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">goto_table_id</span><span class=\"p\">(</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span> <span class=\"n\">aid</span><span class=\"p\">))</span>\n                    <span class=\"p\">]</span>\n                <span class=\"k\">if</span> <span class=\"n\">kwargs</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\">&#39;goto_name&#39;</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">):</span>\n                    <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                        <span class=\"p\">(</span><span class=\"s1\">&#39;Go to name&#39;</span><span class=\"p\">,</span>\n                         <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">goto_table_id</span><span class=\"p\">(</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span>\n                                                      <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_annot_nids</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">))),</span>\n                    <span class=\"p\">]</span>\n                <span class=\"k\">if</span> <span class=\"n\">kwargs</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\">&#39;canedit&#39;</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">):</span>\n                    <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                        <span class=\"p\">(</span><span class=\"s1\">&#39;Edit Annotation in Image&#39;</span><span class=\"p\">,</span>\n                         <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">spawn_edit_image_annotation_interaction_from_aid</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)),</span>\n                    <span class=\"p\">]</span>\n                    <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                        <span class=\"p\">(</span><span class=\"s1\">&#39;Clone annotation</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s species to ImageSet&#39;</span><span class=\"p\">,</span>\n                         <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">copy_species_to_imageset</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)),</span>\n                    <span class=\"p\">]</span>\n\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View annotation in Web&#39;</span><span class=\"p\">,</span>\n                        <span class=\"c1\">#lambda: ibswgt.back.select_aid(aid, imgsetid, show=True)),</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_annotation</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">web</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View image in Web&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_gid_from_aid</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">show</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">web</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Remove annotation</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s name&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">unset_names</span><span class=\"p\">([</span><span class=\"n\">aid</span><span class=\"p\">])),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete annotation&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_annot</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                <span class=\"p\">]</span>\n                <span class=\"kn\">from</span> <span class=\"nn\">ibeis.viz.interact</span> <span class=\"k\">import</span> <span class=\"n\">interact_chip</span>\n                <span class=\"kn\">from</span> <span class=\"nn\">ibeis</span> <span class=\"k\">import</span> <span class=\"n\">viz</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">interact_chip</span><span class=\"o\">.</span><span class=\"n\">build_annot_context_options</span><span class=\"p\">(</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">refresh_func</span><span class=\"o\">=</span><span class=\"n\">viz</span><span class=\"o\">.</span><span class=\"n\">draw</span><span class=\"p\">,</span>\n                    <span class=\"n\">with_interact_image</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View annotations in Web&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_aid_list_in_web</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Unset annotations</span><span class=\"se\">\\&#39;</span><span class=\"s1\"> names&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">unset_names</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete annotations&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_annot</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">return</span> <span class=\"n\">context_options</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">name_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">,</span> <span class=\"n\">aid_list</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">aid</span> <span class=\"o\">=</span> <span class=\"n\">aid_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">build_annot_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">aid</span><span class=\"p\">],</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"k\">def</span> <span class=\"nf\">set_annot_names_to_same_new_name</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">aid_list</span><span class=\"p\">):</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">set_annot_names_to_same_new_name</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_tables</span><span class=\"p\">(</span><span class=\"n\">tblnames</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">])</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Rename annots (</span><span class=\"si\">%s</span><span class=\"s1\">) to new name&#39;</span> <span class=\"o\">%</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">list_str_summarized</span><span class=\"p\">(</span>\n                        <span class=\"n\">aid_list</span><span class=\"p\">,</span> <span class=\"s1\">&#39;aid_list&#39;</span><span class=\"p\">),</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">set_annot_names_to_same_new_name</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">aid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"k\">def</span> <span class=\"nf\">run_splits</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">):</span>\n                    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;Checking for splits&#39;</span><span class=\"p\">)</span>\n                    <span class=\"n\">aids_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_name_aids</span><span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">)</span>\n                    <span class=\"n\">aid_list</span> <span class=\"o\">=</span> <span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">flatten</span><span class=\"p\">(</span><span class=\"n\">aids_list</span><span class=\"p\">))))</span>\n                    <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">run_annot_splits</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span>\n\n                <span class=\"k\">def</span> <span class=\"nf\">export_nids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">):</span>\n                    <span class=\"kn\">from</span> <span class=\"nn\">ibeis.dbio</span> <span class=\"k\">import</span> <span class=\"n\">export_subset</span>\n                    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">are_you_sure</span><span class=\"p\">(</span><span class=\"s1\">&#39;Confirm export of nid_list=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">,)):</span>\n                        <span class=\"k\">return</span>\n                    <span class=\"n\">export_subset</span><span class=\"o\">.</span><span class=\"n\">export_names</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">)</span>\n\n                <span class=\"k\">def</span> <span class=\"nf\">create_new_imageset_from_names_</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">):</span>\n                    <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">create_new_imageset_from_names</span><span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">)</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">update_tables</span><span class=\"p\">([</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">],</span> <span class=\"n\">clear_view_selection</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View name(s) in Web&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_nid_list_in_web</span><span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Check for splits&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">run_splits</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Export names&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">export_nids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Create ImageSet From Name(s)&#39;</span><span class=\"p\">,</span>\n                     <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">create_new_imageset_from_names_</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n\n                <span class=\"kn\">from</span> <span class=\"nn\">ibeis.viz.interact</span> <span class=\"k\">import</span> <span class=\"n\">interact_name</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">interact_name</span><span class=\"o\">.</span><span class=\"n\">build_name_context_options</span><span class=\"p\">(</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">)</span>\n            <span class=\"k\">elif</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"c1\">#from ibeis.viz.interact import interact_name</span>\n                <span class=\"c1\">#context_options += interact_name.build_name_context_options(</span>\n                <span class=\"c1\">#    ibswgt.back.ibs, nid_list)</span>\n                <span class=\"c1\">#print(&#39;nutin&#39;)</span>\n                <span class=\"k\">pass</span>\n            <span class=\"k\">return</span> <span class=\"n\">context_options</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">build_image_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n            <span class=\"n\">current_imagesettext</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_imageset_text</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n            <span class=\"c1\"># Conditional context menu</span>\n\n            <span class=\"k\">def</span> <span class=\"nf\">view_images_in_directory</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">):</span>\n                <span class=\"n\">images</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">images</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)</span>\n                <span class=\"n\">fpaths</span> <span class=\"o\">=</span> <span class=\"n\">images</span><span class=\"o\">.</span><span class=\"n\">paths</span>\n                <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">view_file_in_directory</span><span class=\"p\">(</span><span class=\"n\">fpaths</span><span class=\"p\">)</span>\n\n            <span class=\"k\">def</span> <span class=\"nf\">view_images_in_web</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">):</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_images_in_web</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)</span>\n\n            <span class=\"n\">fmt</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n                <span class=\"s1\">&#39;images&#39;</span><span class=\"p\">:</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">pluralize</span><span class=\"p\">(</span><span class=\"s1\">&#39;image&#39;</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"s1\">&#39;images</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s&#39;</span><span class=\"p\">:</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">pluralize</span><span class=\"p\">(</span><span class=\"s1\">&#39;image</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s&#39;</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"s1\">&#39;annotations&#39;</span><span class=\"p\">:</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">pluralize</span><span class=\"p\">(</span><span class=\"s1\">&#39;annotation&#39;</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"s1\">&#39;times&#39;</span><span class=\"p\">:</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">pluralize</span><span class=\"p\">(</span><span class=\"s1\">&#39;time&#39;</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n            <span class=\"p\">}</span>\n\n            <span class=\"n\">context_options</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;Edit {images</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s} </span><span class=\"si\">{times}</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">fmt</span><span class=\"p\">),</span>\n                 <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">edit_image_time</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;View </span><span class=\"si\">{images}</span><span class=\"s1\"> in Web&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">fmt</span><span class=\"p\">),</span>\n                 <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">view_images_in_web</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;View </span><span class=\"si\">{images}</span><span class=\"s1\"> in Directory&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">fmt</span><span class=\"p\">),</span>\n                 <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">view_images_in_directory</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;---&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;Add annotation from entire </span><span class=\"si\">{images}</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">fmt</span><span class=\"p\">),</span>\n                 <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">add_annotation_from_image</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;Run detection on </span><span class=\"si\">{images}</span><span class=\"s1\"> (can cause duplicates)&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">fmt</span><span class=\"p\">),</span>\n                 <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">run_detection_on_images</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n            <span class=\"p\">]</span>\n\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">gid</span> <span class=\"o\">=</span> <span class=\"n\">gid_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n                <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">imgsetid</span>\n                <span class=\"n\">aid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_image_aids</span><span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">)</span>\n\n                <span class=\"n\">annot_options</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Options aid=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,),</span>\n                     <span class=\"n\">build_annot_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">aid</span><span class=\"p\">],</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">goto_image</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">))</span>\n                    <span class=\"k\">for</span> <span class=\"n\">aid</span> <span class=\"ow\">in</span> <span class=\"n\">aid_list</span>\n                <span class=\"p\">]</span>\n                <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                    <span class=\"n\">annot_option_item</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n                        <span class=\"s1\">&#39;Annot Options (aid=</span><span class=\"si\">%r</span><span class=\"s1\">)&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],),</span>\n                        <span class=\"n\">annot_options</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">][</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n                    <span class=\"p\">)</span>\n                <span class=\"k\">else</span><span class=\"p\">:</span>\n                    <span class=\"n\">annot_option_item</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;Annot Options&#39;</span><span class=\"p\">,</span> <span class=\"n\">annot_options</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">kwargs</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\">&#39;goto_image_in_imgtbl&#39;</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">):</span>\n                    <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                        <span class=\"p\">(</span><span class=\"s1\">&#39;Go to image in Images Table&#39;</span><span class=\"p\">,</span>\n                            <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">goto_table_id</span><span class=\"p\">(</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"n\">gid</span><span class=\"p\">)),</span>\n                    <span class=\"p\">]</span>\n\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View image in Matplotlib&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_gid</span><span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">show</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">web</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View detection image (Hough) [dev]&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_hough_image_</span><span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">)),</span>\n                    <span class=\"n\">annot_option_item</span><span class=\"p\">,</span>\n                <span class=\"p\">]</span>\n            <span class=\"c1\"># Special condition for imagesets</span>\n            <span class=\"k\">if</span> <span class=\"n\">current_imagesettext</span> <span class=\"o\">!=</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">NEW_IMAGESET_IMAGESETTEXT</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Move to new imageset&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">send_to_new_imageset</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s1\">&#39;move&#39;</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Copy to new imageset&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">send_to_new_imageset</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s1\">&#39;copy&#39;</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">if</span> <span class=\"n\">current_imagesettext</span> <span class=\"o\">!=</span> <span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">UNGROUPED_IMAGES_IMAGESETTEXT</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Remove from imageset&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">remove_from_imageset</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n\n            <span class=\"kn\">from</span> <span class=\"nn\">ibeis.viz</span> <span class=\"k\">import</span> <span class=\"n\">viz_graph2</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                <span class=\"p\">(</span><span class=\"s1\">&#39;Graph interaction (Annots)&#39;</span><span class=\"p\">,</span>\n                 <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">viz_graph2</span><span class=\"o\">.</span><span class=\"n\">make_qt_graph_interface</span><span class=\"p\">(</span>\n                     <span class=\"c1\"># ibs, nids=ut.unique(ut.flatten(ibs.get_image_nids(gid_list))),</span>\n                     <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gids</span><span class=\"o\">=</span><span class=\"n\">gid_list</span><span class=\"p\">,</span>\n                     <span class=\"n\">graph_tab</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n                 <span class=\"p\">)),</span>\n            <span class=\"p\">]</span>\n\n            <span class=\"c1\"># Continue the conditional context menu</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"c1\"># We get gid from above</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete image</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s annotations&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_image_annotations</span><span class=\"p\">([</span><span class=\"n\">gid</span><span class=\"p\">])),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete image&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_image</span><span class=\"p\">(</span><span class=\"n\">gid</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete images</span><span class=\"se\">\\&#39;</span><span class=\"s1\"> annotations&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_image_annotations</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete images&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_image</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">return</span> <span class=\"n\">context_options</span>\n\n        <span class=\"c1\"># ---- IMAGESET CONTEXT ----</span>\n        <span class=\"k\">if</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">:</span>\n            <span class=\"c1\"># This is for the benefit of merge imagesets</span>\n            <span class=\"n\">merge_destination_id</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n            <span class=\"n\">imagesettext</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_imageset_text</span><span class=\"p\">(</span><span class=\"n\">merge_destination_id</span><span class=\"p\">)</span>\n            <span class=\"n\">imgsetid_list</span> <span class=\"o\">=</span> <span class=\"n\">level2_ids</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n            <span class=\"c1\"># Conditional context menu</span>\n            <span class=\"c1\"># TODO: remove duplicate code</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;View imageset in Web&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_imgsetid_list_in_web</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Turk imageset</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s detections in Web&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_imgsetid_detection_turk_in_web</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Turk imageset</span><span class=\"se\">\\&#39;</span><span class=\"s1\">s annotations in Web&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">show_imgsetid_annotation_turk_in_web</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Run detection on imageset (can cause duplicates)&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">run_detection_on_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Merge </span><span class=\"si\">%d</span><span class=\"s1\"> imageset into </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span>  <span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"n\">imagesettext</span><span class=\"p\">)),</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">merge_imagesets</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">,</span> <span class=\"n\">merge_destination_id</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Copy imageset&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">copy_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Export imageset&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">export_imagesets</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete imageset&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete imageset AND images&#39;</span><span class=\"p\">,</span>\n                     <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_imageset_and_images</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Mark imageset as Shipped to WildBook&#39;</span><span class=\"p\">,</span>\n                     <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">mark_imageset_as_shipped</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                <span class=\"p\">]</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"p\">[</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Run detection on imagesets (can cause duplicates)&#39;</span><span class=\"p\">,</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">run_detection_on_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Copy imageset&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">copy_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Merge </span><span class=\"si\">%d</span><span class=\"s1\"> imagesets into </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span>  <span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"n\">imagesettext</span><span class=\"p\">)),</span>\n                        <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">merge_imagesets</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">,</span> <span class=\"n\">merge_destination_id</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete imagesets&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_imageset</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;----&#39;</span><span class=\"p\">,</span> <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">),</span>\n                    <span class=\"p\">(</span><span class=\"s1\">&#39;Delete imagesets AND images&#39;</span><span class=\"p\">,</span>\n                     <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">delete_imageset_and_images</span><span class=\"p\">(</span><span class=\"n\">imgsetid_list</span><span class=\"p\">)),</span>\n                    <span class=\"c1\"># (&#39;export imagesets&#39;, lambda: ibswgt.back.export_imagesets(imgsetid_list)),</span>\n                <span class=\"p\">]</span>\n        <span class=\"c1\"># ---- IMAGE CONTEXT ----</span>\n        <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">IMAGE_TABLE</span><span class=\"p\">:</span>\n            <span class=\"n\">gid_list</span> <span class=\"o\">=</span> <span class=\"n\">level2_ids</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n            <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">get_selected_imgsetid</span><span class=\"p\">()</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">build_image_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span>\n                                                           <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"c1\"># ---- IMAGE GRID CONTEXT ----</span>\n        <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">IMAGE_GRID</span><span class=\"p\">:</span>\n            <span class=\"n\">gid_list</span> <span class=\"o\">=</span> <span class=\"n\">level2_ids</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n            <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">get_selected_imgsetid</span><span class=\"p\">()</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">build_image_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span>\n                                                           <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span>\n                                                           <span class=\"n\">goto_image_in_imgtbl</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"c1\"># ---- ANNOTATION CONTEXT ----</span>\n        <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">:</span>\n            <span class=\"n\">aid_list</span> <span class=\"o\">=</span> <span class=\"n\">level2_ids</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n            <span class=\"c1\"># Conditional context menu</span>\n            <span class=\"c1\"># TODO: UNIFY COMMMON CONTEXT MENUS</span>\n            <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">build_annot_context_options</span><span class=\"p\">(</span>\n                <span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">aid_list</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">goto_annot</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n        <span class=\"c1\"># ---- NAMES TREE CONTEXT ----</span>\n        <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">NAMES_TREE</span><span class=\"p\">:</span>\n            <span class=\"c1\"># TODO: map level list to tablename more reliably</span>\n            <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">print_dict</span><span class=\"p\">(</span><span class=\"n\">level2_ids</span><span class=\"p\">)</span>\n            <span class=\"n\">nid_list</span> <span class=\"o\">=</span> <span class=\"n\">level2_ids</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"p\">[])</span>\n            <span class=\"n\">aid_list</span> <span class=\"o\">=</span> <span class=\"n\">level2_ids</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"p\">[])</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">aid_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"ow\">and</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">nid_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"c1\"># two types of indices are selected, just return</span>\n                <span class=\"c1\"># fixme to do something useful</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;multiple types of indicies selected&#39;</span><span class=\"p\">)</span>\n                <span class=\"k\">return</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">imgsetid</span>\n                <span class=\"n\">context_options</span> <span class=\"o\">+=</span> <span class=\"n\">name_context_options</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">nid_list</span><span class=\"p\">,</span> <span class=\"n\">aid_list</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Show the context menu</span>\n        <span class=\"c1\">#ut.print_list(context_options, nl=2)</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">context_options</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">popup_menu</span><span class=\"p\">(</span><span class=\"n\">tblview</span><span class=\"p\">,</span> <span class=\"n\">pos</span><span class=\"p\">,</span> <span class=\"n\">context_options</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.on_doubleclick\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.on_doubleclick\">[docs]</a>    <span class=\"nd\">@slot_</span><span class=\"p\">(</span><span class=\"n\">QtCore</span><span class=\"o\">.</span><span class=\"n\">QModelIndex</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">on_doubleclick</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        Double clicking anywhere in the GUI</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis --db lynx --imgsetid 2 --select-name=goku</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;</span><span class=\"se\">\\n</span><span class=\"s1\">+--- DOUBLE CLICK ---&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">isValid</span><span class=\"p\">():</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[doubleclick] invalid qtindex&#39;</span><span class=\"p\">)</span>\n            <span class=\"k\">return</span>\n        <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">qtindex</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n        <span class=\"n\">id_</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_row_id</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">IMAGESET_TABLE</span><span class=\"p\">:</span>\n            <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">id_</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">select_imageset_tab</span><span class=\"p\">(</span><span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">imgsetid</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">imgsetid</span>\n            <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">IMAGE_TABLE</span><span class=\"p\">)</span> <span class=\"ow\">or</span> <span class=\"p\">(</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">IMAGE_GRID</span><span class=\"p\">):</span>\n                <span class=\"n\">gid</span> <span class=\"o\">=</span> <span class=\"n\">id_</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">spawn_edit_image_annotation_interaction</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">,</span> <span class=\"n\">gid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">:</span>\n                <span class=\"n\">aid</span> <span class=\"o\">=</span> <span class=\"n\">id_</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_aid</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">NAME_TABLE</span><span class=\"p\">:</span>\n                <span class=\"n\">nid</span> <span class=\"o\">=</span> <span class=\"n\">id_</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_nid</span><span class=\"p\">(</span><span class=\"n\">nid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">)</span>\n            <span class=\"k\">elif</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">NAMES_TREE</span><span class=\"p\">:</span>\n                <span class=\"n\">level</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_get_level</span><span class=\"p\">(</span><span class=\"n\">qtindex</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">level</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                    <span class=\"n\">nid</span> <span class=\"o\">=</span> <span class=\"n\">id_</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_nid</span><span class=\"p\">(</span><span class=\"n\">nid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">show</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n                <span class=\"k\">elif</span> <span class=\"n\">level</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                    <span class=\"n\">aid</span> <span class=\"o\">=</span> <span class=\"n\">id_</span>\n                    <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">spawn_edit_image_annotation_interaction_from_aid</span><span class=\"p\">(</span><span class=\"n\">aid</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">qtindex</span><span class=\"p\">)</span></div>\n                    <span class=\"c1\">#ibswgt.back.select_aid(aid, imgsetid, show=True)</span>\n\n    <span class=\"c1\"># @slot_(list)</span>\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.imagesDropped\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.imagesDropped\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">imagesDropped</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">url_list</span><span class=\"p\">):</span>\n        <span class=\"sa\">r</span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        image drag and drop event</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis.gui.newgui imagesDropped --show</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # GUI_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront(&#39;hstest&#39;)</span>\n<span class=\"sd\">            &gt;&gt;&gt; url_list = [ut.grab_test_imgpath(&#39;carl.jpg&#39;), ut.grab_test_imgpath(&#39;lena.png&#39;)]</span>\n<span class=\"sd\">            &gt;&gt;&gt; #url_list += [ut.truepath(&#39;~/Downloads/Clutter/wd_peter2.zip&#39;)]</span>\n<span class=\"sd\">            &gt;&gt;&gt; url = url_list[0]</span>\n<span class=\"sd\">            &gt;&gt;&gt; ut.quit_if_noshow()</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.imagesDropped(url_list)</span>\n<span class=\"sd\">            &gt;&gt;&gt; testdata_main_loop(globals(), locals())</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[drop_event] url_list=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">url_list</span><span class=\"p\">,))</span>\n        <span class=\"n\">has_zipext</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">fpath_has_ext</span><span class=\"p\">,</span> <span class=\"n\">exts</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;.zip&#39;</span><span class=\"p\">])</span>\n        <span class=\"n\">gpath_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">filter</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">fpath_has_imgext</span><span class=\"p\">,</span> <span class=\"n\">url_list</span><span class=\"p\">))</span>\n        <span class=\"n\">dir_list</span>   <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">filter</span><span class=\"p\">(</span><span class=\"n\">isdir</span><span class=\"p\">,</span> <span class=\"n\">url_list</span><span class=\"p\">))</span>\n        <span class=\"n\">zipfile_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">filter</span><span class=\"p\">(</span><span class=\"n\">has_zipext</span><span class=\"p\">,</span> <span class=\"n\">url_list</span><span class=\"p\">))</span>\n        <span class=\"n\">old</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n        <span class=\"k\">if</span> <span class=\"n\">old</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">dir_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">options</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;No&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Yes&#39;</span><span class=\"p\">]</span>\n                <span class=\"n\">title</span>   <span class=\"o\">=</span> <span class=\"s1\">&#39;Non-Images dropped&#39;</span>\n                <span class=\"n\">msg</span>     <span class=\"o\">=</span> <span class=\"s1\">&#39;Recursively import from directories?&#39;</span>\n                <span class=\"n\">ans</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">user_option</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"o\">=</span><span class=\"n\">msg</span><span class=\"p\">,</span> <span class=\"n\">title</span><span class=\"o\">=</span><span class=\"n\">title</span><span class=\"p\">,</span>\n                                          <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"n\">options</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">ans</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;Yes&#39;</span><span class=\"p\">:</span>\n                    <span class=\"n\">unflat_gpaths</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">list_images</span><span class=\"p\">(</span><span class=\"n\">dir_</span><span class=\"p\">,</span> <span class=\"n\">fullpath</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">recursive</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n                                     <span class=\"k\">for</span> <span class=\"n\">dir_</span> <span class=\"ow\">in</span> <span class=\"n\">dir_list</span><span class=\"p\">]</span>\n                    <span class=\"n\">flat_gpaths</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">flatten</span><span class=\"p\">(</span><span class=\"n\">unflat_gpaths</span><span class=\"p\">)</span>\n                    <span class=\"n\">flat_unix_gpaths</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">unixpath</span><span class=\"p\">,</span> <span class=\"n\">flat_gpaths</span><span class=\"p\">))</span>\n                    <span class=\"n\">gpath_list</span><span class=\"o\">.</span><span class=\"n\">extend</span><span class=\"p\">(</span><span class=\"n\">flat_unix_gpaths</span><span class=\"p\">)</span>\n                <span class=\"k\">else</span><span class=\"p\">:</span>\n                    <span class=\"k\">return</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;[drop_event] gpath_list=</span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">gpath_list</span><span class=\"p\">,))</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gpath_list</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">import_images_from_file</span><span class=\"p\">(</span><span class=\"n\">gpath_list</span><span class=\"o\">=</span><span class=\"n\">gpath_list</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"kn\">from</span> <span class=\"nn\">ibeis.dbio</span> <span class=\"k\">import</span> <span class=\"n\">ingest_database</span>\n            <span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span>\n            <span class=\"n\">ingestable</span> <span class=\"o\">=</span> <span class=\"n\">ingest_database</span><span class=\"o\">.</span><span class=\"n\">Ingestable2</span><span class=\"p\">(</span>\n                <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_dbdir</span><span class=\"p\">(),</span> <span class=\"n\">gpath_list</span><span class=\"p\">,</span> <span class=\"n\">dir_list</span><span class=\"p\">,</span> <span class=\"n\">zipfile_list</span><span class=\"p\">)</span>\n            <span class=\"n\">num_gpaths</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ingestable</span><span class=\"o\">.</span><span class=\"n\">imgpath_list</span><span class=\"p\">)</span>\n            <span class=\"n\">num_dpaths</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ingestable</span><span class=\"o\">.</span><span class=\"n\">imgdir_list</span><span class=\"p\">)</span>\n            <span class=\"n\">num_zips</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ingestable</span><span class=\"o\">.</span><span class=\"n\">zipfile_list</span><span class=\"p\">)</span>\n            <span class=\"n\">confirm_list</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n            <span class=\"k\">if</span> <span class=\"n\">num_gpaths</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">confirm_list</span> <span class=\"o\">+=</span> <span class=\"p\">[</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">quantstr</span><span class=\"p\">(</span><span class=\"s1\">&#39;image file&#39;</span><span class=\"p\">,</span> <span class=\"n\">num_gpaths</span><span class=\"p\">)]</span>\n            <span class=\"k\">if</span> <span class=\"n\">num_dpaths</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">confirm_list</span> <span class=\"o\">+=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;recursively from &#39;</span> <span class=\"o\">+</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">quantstr</span><span class=\"p\">(</span><span class=\"s1\">&#39;directory&#39;</span><span class=\"p\">,</span> <span class=\"n\">num_dpaths</span><span class=\"p\">,</span> <span class=\"s1\">&#39;s&#39;</span><span class=\"p\">)]</span>\n            <span class=\"k\">if</span> <span class=\"n\">num_zips</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">confirm_list</span> <span class=\"o\">+=</span> <span class=\"p\">[</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">quantstr</span><span class=\"p\">(</span><span class=\"s1\">&#39;zip file&#39;</span><span class=\"p\">,</span> <span class=\"n\">num_zips</span><span class=\"p\">,</span> <span class=\"s1\">&#39;s&#39;</span><span class=\"p\">)]</span>\n            <span class=\"n\">confirm_msg</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;Import from: &#39;</span> <span class=\"o\">+</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">conj_phrase</span><span class=\"p\">(</span><span class=\"n\">confirm_list</span><span class=\"p\">,</span> <span class=\"s1\">&#39;and&#39;</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;.&#39;</span>\n            <span class=\"c1\"># gt.rrrr()</span>\n            <span class=\"n\">config</span> <span class=\"o\">=</span> <span class=\"n\">ingestable</span><span class=\"o\">.</span><span class=\"n\">ingest_config</span>\n            <span class=\"c1\"># cfg = config</span>\n            <span class=\"n\">dlg</span> <span class=\"o\">=</span> <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">ConfigConfirmWidget</span><span class=\"o\">.</span><span class=\"n\">as_dialog</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span>\n                                                        <span class=\"n\">title</span><span class=\"o\">=</span><span class=\"s1\">&#39;Confirm Import Images&#39;</span><span class=\"p\">,</span>\n                                                        <span class=\"n\">msg</span><span class=\"o\">=</span><span class=\"n\">confirm_msg</span><span class=\"p\">,</span>\n                                                        <span class=\"n\">config</span><span class=\"o\">=</span><span class=\"n\">config</span><span class=\"p\">)</span>\n            <span class=\"n\">dlg</span><span class=\"o\">.</span><span class=\"n\">resize</span><span class=\"p\">(</span><span class=\"mi\">700</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">)</span>\n            <span class=\"bp\">self</span> <span class=\"o\">=</span> <span class=\"n\">dlg</span><span class=\"o\">.</span><span class=\"n\">widget</span>\n            <span class=\"n\">dlg</span><span class=\"o\">.</span><span class=\"n\">exec_</span><span class=\"p\">()</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;config = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">config</span><span class=\"p\">,))</span>\n            <span class=\"n\">updated_config</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span>  <span class=\"c1\"># NOQA</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;updated_config = </span><span class=\"si\">%r</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">updated_config</span><span class=\"p\">,))</span>\n            <span class=\"n\">gid_list</span> <span class=\"o\">=</span> <span class=\"n\">ingestable</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"o\">=</span><span class=\"n\">ibs</span><span class=\"p\">)</span>\n            <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">_process_new_images</span><span class=\"p\">(</span><span class=\"n\">refresh</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"o\">=</span><span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">clock_offset</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.select_table_id\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.select_table_id\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">select_table_id</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">table_key</span><span class=\"p\">,</span> <span class=\"n\">level</span><span class=\"p\">,</span> <span class=\"n\">id_</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">):</span>\n        <span class=\"n\">select_func_dict</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"p\">(</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>         <span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_gid</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">IMAGE_GRID</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_gid</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_aid</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">NAME_TABLE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_nid</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_nid</span><span class=\"p\">,</span>\n            <span class=\"p\">(</span><span class=\"n\">NAMES_TREE</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>          <span class=\"p\">:</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">select_aid</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">select_func</span> <span class=\"o\">=</span> <span class=\"n\">select_func_dict</span><span class=\"p\">[(</span><span class=\"n\">table_key</span><span class=\"p\">,</span> <span class=\"n\">level</span><span class=\"p\">)]</span>\n        <span class=\"n\">select_func</span><span class=\"p\">(</span><span class=\"n\">id_</span><span class=\"p\">,</span> <span class=\"n\">imgsetid</span><span class=\"p\">,</span> <span class=\"n\">show</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.edit_image_time\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.edit_image_time\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">edit_image_time</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis.gui.newgui --exec-edit_image_time --show</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront(&#39;testdb3&#39;)</span>\n<span class=\"sd\">            &gt;&gt;&gt; #ibs, back, ibswgt, testdata_main_loop = testdata_guifront(&#39;lynx&#39;)</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibswgt.edit_image_time([277, 630])</span>\n<span class=\"sd\">            &gt;&gt;&gt; testdata_main_loop(globals(), locals())</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">ibeis.gui</span> <span class=\"k\">import</span> <span class=\"n\">clock_offset_gui</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">co_wgt</span> <span class=\"o\">=</span> <span class=\"n\">clock_offset_gui</span><span class=\"o\">.</span><span class=\"n\">ClockOffsetWidget</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">hack</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">co_wgt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"IBEISGuiWidget.filter_annotation_table\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.IBEISGuiWidget.filter_annotation_table\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">filter_annotation_table</span><span class=\"p\">(</span><span class=\"n\">ibswgt</span><span class=\"p\">):</span>\n        <span class=\"sa\">r</span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        TODO:  Finish implementation</span>\n\n<span class=\"sd\">        CommandLine:</span>\n<span class=\"sd\">            python -m ibeis.gui.newgui --test-filter_annotation_table --show --db lynx --imgsetid 2</span>\n\n<span class=\"sd\">        Example:</span>\n<span class=\"sd\">            &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">            &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">            &gt;&gt;&gt; ibs, back, ibswgt, testdata_main_loop = testdata_guifront(&#39;testdb3&#39;)</span>\n<span class=\"sd\">            &gt;&gt;&gt; #ibs, back, ibswgt, testdata_main_loop = testdata_guifront(&#39;PZ_Master1&#39;)</span>\n<span class=\"sd\">            &gt;&gt;&gt; result = ibswgt.filter_annotation_table()</span>\n<span class=\"sd\">            &gt;&gt;&gt; print(result)</span>\n<span class=\"sd\">            &gt;&gt;&gt; testdata_main_loop(globals(), locals())</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">functools</span> <span class=\"k\">import</span> <span class=\"n\">partial</span>\n\n        <span class=\"c1\">#ibs.filter_annots_general()</span>\n\n        <span class=\"n\">ibs</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibs</span>\n\n        <span class=\"c1\">#ibs.filterannots_by_tags(aid_list)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;</span><span class=\"se\">\\n</span><span class=\"s1\">------FILTERING ANNOTS</span><span class=\"se\">\\n\\n</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n        <span class=\"c1\">#annotmatch_rowid_list = ibs._get_all_annotmatch_rowids()</span>\n        <span class=\"c1\">#isscenerymatch_list = ibs.get_annotmatch_is_scenerymatch(annotmatch_rowid_list)</span>\n        <span class=\"c1\">#ut.take(isscenerymatch_list, ut.list_where(isscenerymatch_list))</span>\n\n        <span class=\"c1\"># Applies annotation based filtering to the annotation table</span>\n        <span class=\"c1\">#filter_kw = dict(any_matches=&#39;.*error.*&#39;, been_adjusted=True)</span>\n        <span class=\"n\">filter_kw</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">been_adjusted</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n        <span class=\"c1\">#filter_kw = dict(require_timestamp=True)</span>\n        <span class=\"n\">filter_fn</span> <span class=\"o\">=</span> <span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">filter_annots_general</span><span class=\"p\">,</span> <span class=\"n\">filter_kw</span><span class=\"o\">=</span><span class=\"n\">filter_kw</span><span class=\"p\">)</span>\n\n        <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">models</span><span class=\"p\">[</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">ANNOTATION_TABLE</span><span class=\"p\">]</span>  <span class=\"c1\"># NOQA</span>\n        <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">set_ider_filters</span><span class=\"p\">([</span><span class=\"n\">filter_fn</span><span class=\"p\">])</span>\n        <span class=\"k\">with</span> <span class=\"n\">ChangeLayoutContext</span><span class=\"p\">([</span><span class=\"n\">model</span><span class=\"p\">]):</span>\n            <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">_update_rows</span><span class=\"p\">(</span><span class=\"n\">rebuild_structure</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span></div></div>\n\n\n<span class=\"c1\">######################</span>\n<span class=\"c1\">###### Testing #######</span>\n<span class=\"c1\">######################</span>\n\n<div class=\"viewcode-block\" id=\"testdata_guifront\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.testdata_guifront\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">testdata_guifront</span><span class=\"p\">(</span><span class=\"n\">defaultdb</span><span class=\"o\">=</span><span class=\"s1\">&#39;testdb1&#39;</span><span class=\"p\">):</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">ibeis</span>\n    <span class=\"n\">main_locals</span> <span class=\"o\">=</span> <span class=\"n\">ibeis</span><span class=\"o\">.</span><span class=\"n\">main</span><span class=\"p\">(</span><span class=\"n\">defaultdb</span><span class=\"o\">=</span><span class=\"n\">defaultdb</span><span class=\"p\">,</span> <span class=\"n\">allow_newdir</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">back</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">dict_take</span><span class=\"p\">(</span><span class=\"n\">main_locals</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"s1\">&#39;ibs&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;back&#39;</span><span class=\"p\">])</span>\n    <span class=\"n\">ibswgt</span> <span class=\"o\">=</span> <span class=\"n\">back</span><span class=\"o\">.</span><span class=\"n\">ibswgt</span>  <span class=\"c1\"># NOQA</span>\n    <span class=\"n\">globals__</span> <span class=\"o\">=</span> <span class=\"nb\">globals</span><span class=\"p\">()</span>\n    <span class=\"n\">locals__</span>  <span class=\"o\">=</span> <span class=\"nb\">locals</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">testdata_main_loop</span><span class=\"p\">(</span><span class=\"n\">globals_</span><span class=\"o\">=</span><span class=\"n\">globals__</span><span class=\"p\">,</span> <span class=\"n\">locals_</span><span class=\"o\">=</span><span class=\"n\">locals__</span><span class=\"p\">):</span>\n        <span class=\"n\">locals_</span>  <span class=\"o\">=</span> <span class=\"n\">locals_</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n        <span class=\"n\">globals_</span> <span class=\"o\">=</span> <span class=\"n\">globals_</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n        <span class=\"n\">locals_</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">locals__</span><span class=\"p\">)</span>\n        <span class=\"n\">globals_</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">globals__</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"s1\">&#39;--cmd&#39;</span> <span class=\"ow\">in</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">:</span>\n            <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">qtapp_loop</span><span class=\"p\">(</span><span class=\"n\">qwin</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">ipy</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n            <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">exec_</span><span class=\"p\">(</span><span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">ipython_execstr</span><span class=\"p\">(),</span> <span class=\"n\">globals_</span><span class=\"p\">,</span> <span class=\"n\">locals_</span><span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">show_was_requested</span><span class=\"p\">():</span>\n            <span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">qtapp_loop</span><span class=\"p\">(</span><span class=\"n\">qwin</span><span class=\"o\">=</span><span class=\"n\">ibswgt</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">back</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">testdata_main_loop</span></div>\n\n\n<div class=\"viewcode-block\" id=\"testfunc\"><a class=\"viewcode-back\" href=\"../../../../ibeis.gui/#ibeis.gui.newgui.testfunc\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">testfunc</span><span class=\"p\">():</span>\n    <span class=\"sa\">r</span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    CommandLine:</span>\n<span class=\"sd\">        python -m ibeis.gui.newgui --test-testfunc --show</span>\n<span class=\"sd\">        python -m ibeis.gui.newgui --test-testfunc --cmd</span>\n\n<span class=\"sd\">    Example:</span>\n<span class=\"sd\">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>\n<span class=\"sd\">        &gt;&gt;&gt; from ibeis.gui.newgui import *  # NOQA</span>\n<span class=\"sd\">        &gt;&gt;&gt; result = testfunc()</span>\n<span class=\"sd\">        &gt;&gt;&gt; print(result)</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">back</span><span class=\"p\">,</span> <span class=\"n\">ibswgt</span><span class=\"p\">,</span> <span class=\"n\">testdata_main_loop</span> <span class=\"o\">=</span> <span class=\"n\">testdata_guifront</span><span class=\"p\">()</span>\n    <span class=\"n\">view</span> <span class=\"o\">=</span> <span class=\"n\">ibswgt</span><span class=\"o\">.</span><span class=\"n\">views</span><span class=\"p\">[</span><span class=\"n\">gh</span><span class=\"o\">.</span><span class=\"n\">IMAGE_TABLE</span><span class=\"p\">]</span>\n    <span class=\"n\">testdata_main_loop</span><span class=\"p\">(</span><span class=\"nb\">globals</span><span class=\"p\">(),</span> <span class=\"nb\">locals</span><span class=\"p\">())</span></div>\n\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;__main__&#39;</span><span class=\"p\">:</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    CommandLine:</span>\n<span class=\"sd\">        python -m ibeis.gui.newgui</span>\n<span class=\"sd\">        python -m ibeis.gui.newgui --allexamples</span>\n<span class=\"sd\">        python -m ibeis.gui.newgui --allexamples --noface --nosrc</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">multiprocessing</span>\n    <span class=\"n\">multiprocessing</span><span class=\"o\">.</span><span class=\"n\">freeze_support</span><span class=\"p\">()</span>  <span class=\"c1\"># for win32</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">utool</span> <span class=\"k\">as</span> <span class=\"nn\">ut</span>  <span class=\"c1\"># NOQA</span>\n    <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">doctest_funcs</span><span class=\"p\">()</span>\n</pre></div>", "current_page_name": "_modules/ibeis/gui/newgui", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}