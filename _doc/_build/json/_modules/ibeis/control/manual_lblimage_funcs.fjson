{"parents": [{"link": "../../../", "title": "Module code"}, {"link": "../../", "title": "ibeis"}, {"link": "../", "title": "ibeis.control"}], "title": "ibeis.control.manual_lblimage_funcs", "body": "<h1>Source code for ibeis.control.manual_lblimage_funcs</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"c1\"># -*- coding: utf-8 -*-</span>\n<span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"k\">import</span> <span class=\"n\">absolute_import</span><span class=\"p\">,</span> <span class=\"n\">division</span><span class=\"p\">,</span> <span class=\"n\">print_function</span>\n<span class=\"kn\">import</span> <span class=\"nn\">uuid</span>\n<span class=\"kn\">import</span> <span class=\"nn\">six</span>  <span class=\"c1\"># NOQA</span>\n<span class=\"kn\">from</span> <span class=\"nn\">six.moves</span> <span class=\"k\">import</span> <span class=\"nb\">range</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis</span> <span class=\"k\">import</span> <span class=\"n\">constants</span> <span class=\"k\">as</span> <span class=\"n\">const</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.control.accessor_decors</span> <span class=\"k\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">adder</span><span class=\"p\">,</span> <span class=\"n\">getter_1to1</span><span class=\"p\">,</span> <span class=\"n\">default_decorator</span><span class=\"p\">,</span> <span class=\"n\">getter_1toM</span><span class=\"p\">)</span>\n<span class=\"kn\">import</span> <span class=\"nn\">utool</span> <span class=\"k\">as</span> <span class=\"nn\">ut</span>\n<span class=\"c1\">#from ibeis.other import ibsfuncs</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ibeis.control.controller_inject</span> <span class=\"k\">import</span> <span class=\"n\">make_ibs_register_decorator</span>\n<span class=\"nb\">print</span><span class=\"p\">,</span> <span class=\"n\">rrr</span><span class=\"p\">,</span> <span class=\"n\">profile</span> <span class=\"o\">=</span> <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">inject2</span><span class=\"p\">(</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">CLASS_INJECT_KEY</span><span class=\"p\">,</span> <span class=\"n\">register_ibs_method</span> <span class=\"o\">=</span> <span class=\"n\">make_ibs_register_decorator</span><span class=\"p\">(</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n\n\n<span class=\"c1\"># ADDERS::IMAGE-&gt;IMAGESET</span>\n\n<span class=\"c1\">#</span>\n<span class=\"c1\"># GETTERS::GLR</span>\n\n\n<div class=\"viewcode-block\" id=\"get_glr_confidence\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_glr_confidence\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_glr_confidence</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">glrid_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Returns:</span>\n<span class=\"sd\">        list_ (list):  confidence in an image relationship &quot;&quot;&quot;</span>\n    <span class=\"n\">glr_confidence_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;glr_confidence&#39;</span><span class=\"p\">,),</span> <span class=\"n\">glrid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">glr_confidence_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_glr_lblimage_rowids\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_glr_lblimage_rowids\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_glr_lblimage_rowids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">glrid_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot; get the lblimage_rowid belonging to each relationship &quot;&quot;&quot;</span>\n    <span class=\"n\">lblimage_rowids_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lblimage_rowid&#39;</span><span class=\"p\">,),</span> <span class=\"n\">glrid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimage_rowids_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_glr_image_rowids\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_glr_image_rowids\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_glr_image_rowids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">glrid_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot; get the image_rowid belonging to each relationship &quot;&quot;&quot;</span>\n    <span class=\"n\">image_rowids_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;image_rowid&#39;</span><span class=\"p\">,),</span> <span class=\"n\">glrid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">image_rowids_list</span></div>\n\n\n<span class=\"c1\"># ADDERS::LBLIMAGE</span>\n\n\n<div class=\"viewcode-block\" id=\"add_lblimages\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.add_lblimages\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@adder</span>\n<span class=\"k\">def</span> <span class=\"nf\">add_lblimages</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lbltype_rowid_list</span><span class=\"p\">,</span> <span class=\"n\">value_list</span><span class=\"p\">,</span> <span class=\"n\">note_list</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">lblimage_uuid_list</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot; Adds new lblimages (labels of imageations)</span>\n<span class=\"sd\">    creates a new uuid for any new pair(type, value)</span>\n<span class=\"sd\">    #TODO: reverse order of rowid_list value_list in input</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">if</span> <span class=\"n\">note_list</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"n\">note_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">value_list</span><span class=\"p\">)</span>\n    <span class=\"c1\"># Get random uuids</span>\n    <span class=\"k\">if</span> <span class=\"n\">lblimage_uuid_list</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"n\">lblimage_uuid_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">uuid</span><span class=\"o\">.</span><span class=\"n\">uuid4</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">value_list</span><span class=\"p\">))]</span>\n    <span class=\"n\">colnames</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;lblimage_uuid&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lbltype_rowid&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lblimage_value&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lblimage_note&#39;</span><span class=\"p\">]</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">lblimage_uuid_list</span><span class=\"p\">,</span> <span class=\"n\">lbltype_rowid_list</span><span class=\"p\">,</span> <span class=\"n\">value_list</span><span class=\"p\">,</span> <span class=\"n\">note_list</span><span class=\"p\">))</span>\n    <span class=\"n\">get_rowid_from_superkey</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_lblimage_rowid_from_superkey</span>\n    <span class=\"n\">superkey_paramx</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n    <span class=\"n\">lblimage_rowid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">add_cleanly</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"n\">colnames</span><span class=\"p\">,</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span>\n                                             <span class=\"n\">get_rowid_from_superkey</span><span class=\"p\">,</span> <span class=\"n\">superkey_paramx</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimage_rowid_list</span></div>\n\n\n<span class=\"c1\">#</span>\n<span class=\"c1\"># GETTERS::LBLIMAGE_TABLE</span>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_rowid_from_superkey\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_rowid_from_superkey\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_rowid_from_superkey</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lbltype_rowid_list</span><span class=\"p\">,</span> <span class=\"n\">value_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Returns:</span>\n<span class=\"sd\">        list_ (list):  lblimage_rowid_list from the superkey (lbltype, value)</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">colnames</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lblimage_rowid&#39;</span><span class=\"p\">,)</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">lbltype_rowid_list</span><span class=\"p\">,</span> <span class=\"n\">value_list</span><span class=\"p\">)</span>\n    <span class=\"n\">where_clause</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;lbltype_rowid=? AND lblimage_value=?&#39;</span>\n    <span class=\"n\">lblimage_rowid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get_where</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"n\">colnames</span><span class=\"p\">,</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span> <span class=\"n\">where_clause</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimage_rowid_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_rowid_from_uuid\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_rowid_from_uuid\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_rowid_from_uuid</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lblimage_uuid_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Returns:</span>\n<span class=\"sd\">        list_ (list):  lblimage_rowid_list from the superkey (lbltype, value)</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">colnames</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lblimage_rowid&#39;</span><span class=\"p\">,)</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"n\">lblimage_uuid_list</span>\n    <span class=\"n\">id_colname</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;lblimage_uuid&#39;</span>\n    <span class=\"n\">lblimage_rowid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"n\">colnames</span><span class=\"p\">,</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span> <span class=\"n\">id_colname</span><span class=\"o\">=</span><span class=\"n\">id_colname</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimage_rowid_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_uuids\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_uuids\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_uuids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">):</span>\n    <span class=\"n\">lblimageuuid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lblimage_uuid&#39;</span><span class=\"p\">,),</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimageuuid_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_lbltypes_rowids\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_lbltypes_rowids\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_lbltypes_rowids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">):</span>\n    <span class=\"n\">lbltype_rowid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lbltype_rowid&#39;</span><span class=\"p\">,),</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lbltype_rowid_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_notes\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_notes\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_notes</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">):</span>\n    <span class=\"n\">lblimagenotes_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lblimage_note&#39;</span><span class=\"p\">,),</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimagenotes_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_values\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_values\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_values</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">,</span> <span class=\"n\">_lbltype</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Returns:</span>\n<span class=\"sd\">        list_ (list): text lblimages &quot;&quot;&quot;</span>\n    <span class=\"c1\">#TODO: Remove keyword argument</span>\n    <span class=\"c1\">#ibsfuncs.assert_lblimage_rowids_are_type(ibs, lblimage_rowid_list,  ibs.lbltype_ids[_lbltype])</span>\n    <span class=\"n\">lblimage_value_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">LBLIMAGE_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;lblimage_value&#39;</span><span class=\"p\">,),</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">lblimage_value_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_lblimage_gids\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_lblimage_gids\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@default_decorator</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_lblimage_gids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">):</span>\n    <span class=\"c1\">#verbose = len(lblimage_rowid_list) &gt; 20</span>\n    <span class=\"c1\"># TODO: Optimize IF POSSIBLE</span>\n    <span class=\"c1\"># FIXME: SLOW</span>\n    <span class=\"c1\">#if verbose:</span>\n    <span class=\"c1\">#    print(ut.get_caller_name(N=list(range(0, 20))))</span>\n    <span class=\"n\">where_clause</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;lblimage_rowid=?&#39;</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"p\">[(</span><span class=\"n\">lblimage_rowid</span><span class=\"p\">,)</span> <span class=\"k\">for</span> <span class=\"n\">lblimage_rowid</span> <span class=\"ow\">in</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">]</span>\n    <span class=\"n\">gids_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get_where</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;image_rowid&#39;</span><span class=\"p\">,),</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span>\n                                 <span class=\"n\">where_clause</span><span class=\"p\">,</span> <span class=\"n\">unpack_scalars</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">gids_list</span></div>\n\n\n<span class=\"c1\"># ADDERS::GLR</span>\n\n\n<div class=\"viewcode-block\" id=\"add_image_relationship_one\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.add_image_relationship_one\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@adder</span>\n<span class=\"k\">def</span> <span class=\"nf\">add_image_relationship_one</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">,</span>\n                               <span class=\"n\">glr_confidence_list</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot; Adds a relationship between images and lblimages</span>\n<span class=\"sd\">        (imageations and labels of imageations) &quot;&quot;&quot;</span>\n    <span class=\"k\">if</span> <span class=\"n\">glr_confidence_list</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"n\">glr_confidence_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.0</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">)</span>\n    <span class=\"n\">colnames</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;image_rowid&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lblimage_rowid&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;glr_confidence&#39;</span><span class=\"p\">,)</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">,</span> <span class=\"n\">glr_confidence_list</span><span class=\"p\">))</span>\n    <span class=\"n\">get_rowid_from_superkey</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">get_glrid_from_superkey</span>\n    <span class=\"n\">superkey_paramx</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>  <span class=\"c1\"># TODO HAVE SQL GIVE YOU THESE NUMBERS</span>\n    <span class=\"n\">glrid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">add_cleanly</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"n\">colnames</span><span class=\"p\">,</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span>\n                                    <span class=\"n\">get_rowid_from_superkey</span><span class=\"p\">,</span> <span class=\"n\">superkey_paramx</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">glrid_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_glrid_from_superkey\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_glrid_from_superkey\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1to1</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_glrid_from_superkey</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        gid_list (list): list of image row-ids</span>\n<span class=\"sd\">        lblimage_rowid_list (list): list of lblimage row-ids</span>\n<span class=\"sd\">    Returns:</span>\n<span class=\"sd\">        glrid_list (list): image-label relationship id list</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">colnames</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;image_rowid&#39;</span><span class=\"p\">,)</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">gid_list</span><span class=\"p\">,</span> <span class=\"n\">lblimage_rowid_list</span><span class=\"p\">)</span>\n    <span class=\"n\">where_clause</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;image_rowid=? AND lblimage_rowid=?&#39;</span>\n    <span class=\"n\">glrid_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get_where</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"n\">colnames</span><span class=\"p\">,</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span> <span class=\"n\">where_clause</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">glrid_list</span></div>\n\n\n<div class=\"viewcode-block\" id=\"get_image_glrids\"><a class=\"viewcode-back\" href=\"../../../../ibeis.control/#ibeis.control.manual_lblimage_funcs.get_image_glrids\">[docs]</a><span class=\"nd\">@register_ibs_method</span>\n<span class=\"nd\">@getter_1toM</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_image_glrids</span><span class=\"p\">(</span><span class=\"n\">ibs</span><span class=\"p\">,</span> <span class=\"n\">gid_list</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot; FIXME: __name__</span>\n<span class=\"sd\">    Get all the relationship ids belonging to the input images</span>\n<span class=\"sd\">    if lblimage lbltype is specified the relationship ids are filtered to</span>\n<span class=\"sd\">    be only of a specific lbltype/category/type</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">params_iter</span> <span class=\"o\">=</span> <span class=\"p\">((</span><span class=\"n\">gid</span><span class=\"p\">,)</span> <span class=\"k\">for</span> <span class=\"n\">gid</span> <span class=\"ow\">in</span> <span class=\"n\">gid_list</span><span class=\"p\">)</span>\n    <span class=\"n\">where_clause</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;image_rowid=?&#39;</span>\n    <span class=\"n\">glrids_list</span> <span class=\"o\">=</span> <span class=\"n\">ibs</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">get_where</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"o\">.</span><span class=\"n\">GL_RELATION_TABLE</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"s1\">&#39;glr_rowid&#39;</span><span class=\"p\">,),</span> <span class=\"n\">params_iter</span><span class=\"p\">,</span>\n                                   <span class=\"n\">where_clause</span><span class=\"o\">=</span><span class=\"n\">where_clause</span><span class=\"p\">,</span> <span class=\"n\">unpack_scalars</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">glrids_list</span></div>\n\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;__main__&#39;</span><span class=\"p\">:</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    CommandLine:</span>\n<span class=\"sd\">        python -m ibeis.control.manual_lblimage_funcs</span>\n<span class=\"sd\">        python -m ibeis.control.manual_lblimage_funcs --allexamples</span>\n<span class=\"sd\">        python -m ibeis.control.manual_lblimage_funcs --allexamples --noface --nosrc</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">multiprocessing</span>\n    <span class=\"n\">multiprocessing</span><span class=\"o\">.</span><span class=\"n\">freeze_support</span><span class=\"p\">()</span>  <span class=\"c1\"># for win32</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">utool</span> <span class=\"k\">as</span> <span class=\"nn\">ut</span>  <span class=\"c1\"># NOQA</span>\n    <span class=\"n\">ut</span><span class=\"o\">.</span><span class=\"n\">doctest_funcs</span><span class=\"p\">()</span>\n</pre></div>", "current_page_name": "_modules/ibeis/control/manual_lblimage_funcs", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}