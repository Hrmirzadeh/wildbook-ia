{"parents": [{"link": "../../../../../", "title": "Module code"}, {"link": "../../../../", "title": "ibeis"}, {"link": "../../../", "title": "ibeis.algo"}, {"link": "../../", "title": "ibeis.algo.detect"}], "title": "ibeis.algo.detect.nms.py_cpu_nms", "body": "<h1>Source code for ibeis.algo.detect.nms.py_cpu_nms</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"c1\"># --------------------------------------------------------</span>\n<span class=\"c1\"># Fast R-CNN</span>\n<span class=\"c1\"># Copyright (c) 2015 Microsoft</span>\n<span class=\"c1\"># Licensed under The MIT License [see LICENSE for details]</span>\n<span class=\"c1\"># Written by Ross Girshick</span>\n<span class=\"c1\"># --------------------------------------------------------</span>\n\n\n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n\n\n<div class=\"viewcode-block\" id=\"py_cpu_nms\"><a class=\"viewcode-back\" href=\"../../../../../../ibeis.algo.detect.nms/#ibeis.algo.detect.nms.py_cpu_nms.py_cpu_nms\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">py_cpu_nms</span><span class=\"p\">(</span><span class=\"n\">dets</span><span class=\"p\">,</span> <span class=\"n\">scores</span><span class=\"p\">,</span> <span class=\"n\">thresh</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Pure Python NMS baseline.&quot;&quot;&quot;</span>\n    <span class=\"n\">x1</span> <span class=\"o\">=</span> <span class=\"n\">dets</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n    <span class=\"n\">y1</span> <span class=\"o\">=</span> <span class=\"n\">dets</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">x2</span> <span class=\"o\">=</span> <span class=\"n\">dets</span><span class=\"p\">[:,</span> <span class=\"mi\">2</span><span class=\"p\">]</span>\n    <span class=\"n\">y2</span> <span class=\"o\">=</span> <span class=\"n\">dets</span><span class=\"p\">[:,</span> <span class=\"mi\">3</span><span class=\"p\">]</span>\n\n    <span class=\"n\">areas</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">x2</span> <span class=\"o\">-</span> <span class=\"n\">x1</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"p\">(</span><span class=\"n\">y2</span> <span class=\"o\">-</span> <span class=\"n\">y1</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n    <span class=\"n\">order</span> <span class=\"o\">=</span> <span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">argsort</span><span class=\"p\">()[::</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n\n    <span class=\"n\">keep</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"k\">while</span> <span class=\"n\">order</span><span class=\"o\">.</span><span class=\"n\">size</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n        <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"n\">order</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n        <span class=\"n\">keep</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n        <span class=\"n\">xx1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">maximum</span><span class=\"p\">(</span><span class=\"n\">x1</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">x1</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]])</span>\n        <span class=\"n\">yy1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">maximum</span><span class=\"p\">(</span><span class=\"n\">y1</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">y1</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]])</span>\n        <span class=\"n\">xx2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">minimum</span><span class=\"p\">(</span><span class=\"n\">x2</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">x2</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]])</span>\n        <span class=\"n\">yy2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">minimum</span><span class=\"p\">(</span><span class=\"n\">y2</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">y2</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]])</span>\n\n        <span class=\"n\">w</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">maximum</span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"n\">xx2</span> <span class=\"o\">-</span> <span class=\"n\">xx1</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n        <span class=\"n\">h</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">maximum</span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"n\">yy2</span> <span class=\"o\">-</span> <span class=\"n\">yy1</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n        <span class=\"n\">inter</span> <span class=\"o\">=</span> <span class=\"n\">w</span> <span class=\"o\">*</span> <span class=\"n\">h</span>\n        <span class=\"n\">ovr</span> <span class=\"o\">=</span> <span class=\"n\">inter</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">areas</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">areas</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]]</span> <span class=\"o\">-</span> <span class=\"n\">inter</span><span class=\"p\">)</span>\n\n        <span class=\"n\">inds</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span><span class=\"n\">ovr</span> <span class=\"o\">&lt;=</span> <span class=\"n\">thresh</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n        <span class=\"n\">order</span> <span class=\"o\">=</span> <span class=\"n\">order</span><span class=\"p\">[</span><span class=\"n\">inds</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">keep</span></div>\n</pre></div>", "current_page_name": "_modules/ibeis/algo/detect/nms/py_cpu_nms", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}