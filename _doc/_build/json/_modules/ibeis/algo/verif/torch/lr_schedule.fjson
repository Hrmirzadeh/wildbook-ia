{"parents": [{"link": "../../../../../", "title": "Module code"}, {"link": "../../../../", "title": "ibeis"}, {"link": "../../../", "title": "ibeis.algo"}, {"link": "../../", "title": "ibeis.algo.verif"}], "title": "ibeis.algo.verif.torch.lr_schedule", "body": "<h1>Source code for ibeis.algo.verif.torch.lr_schedule</h1><div class=\"highlight\"><pre>\n<span></span>\n<div class=\"viewcode-block\" id=\"Exponential\"><a class=\"viewcode-back\" href=\"../../../../../../ibeis.algo.verif.torch/#ibeis.algo.verif.torch.lr_schedule.Exponential\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">Exponential</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Decay learning rate by a factor of `decay_rate` every `lr_decay_epoch`</span>\n<span class=\"sd\">    epochs.</span>\n\n<span class=\"sd\">    Example:</span>\n<span class=\"sd\">        &gt;&gt;&gt; from ibeis.algo.verif.torch.lr_schedule import *</span>\n<span class=\"sd\">        &gt;&gt;&gt; lr_scheduler = Exponential()</span>\n<span class=\"sd\">        &gt;&gt;&gt; rates = np.array([lr_scheduler(i) for i in range(6)])</span>\n<span class=\"sd\">        &gt;&gt;&gt; target = np.array([1E-3, 1E-3, 1E-5, 1E-5, 1E-7, 1E-7])</span>\n<span class=\"sd\">        &gt;&gt;&gt; assert all(list(np.isclose(target, rates)))</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">init_lr</span><span class=\"o\">=</span><span class=\"mf\">0.001</span><span class=\"p\">,</span> <span class=\"n\">decay_rate</span><span class=\"o\">=</span><span class=\"mf\">0.01</span><span class=\"p\">,</span> <span class=\"n\">lr_decay_epoch</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">init_lr</span> <span class=\"o\">=</span> <span class=\"n\">init_lr</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">decay_rate</span> <span class=\"o\">=</span> <span class=\"mf\">0.01</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">lr_decay_epoch</span> <span class=\"o\">=</span> <span class=\"n\">lr_decay_epoch</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">__call__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">epoch</span><span class=\"p\">,</span> <span class=\"n\">optimizer</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        If optimizer is specified, its learning rate is modified inplace.</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"n\">n_decays</span> <span class=\"o\">=</span> <span class=\"n\">epoch</span> <span class=\"o\">//</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">lr_decay_epoch</span>\n        <span class=\"n\">lr</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">init_lr</span> <span class=\"o\">*</span> <span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">decay_rate</span> <span class=\"o\">**</span> <span class=\"n\">n_decays</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">optimizer</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"k\">for</span> <span class=\"n\">param_group</span> <span class=\"ow\">in</span> <span class=\"n\">optimizer</span><span class=\"o\">.</span><span class=\"n\">param_groups</span><span class=\"p\">:</span>\n                <span class=\"n\">param_group</span><span class=\"p\">[</span><span class=\"s1\">&#39;lr&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">lr</span>\n        <span class=\"k\">return</span> <span class=\"n\">lr</span></div>\n</pre></div>", "current_page_name": "_modules/ibeis/algo/verif/torch/lr_schedule", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}